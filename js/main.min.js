var NL=(function(){if("sessionStorage" in window&&sessionStorage.language){return sessionStorage.language}var a=navigator.language?navigator.language:"en";if(a.toLowerCase().substr(0,2)!=="zh"){a="en"}else{if(a.toLowerCase().substr(3,2)==="cn"){a="cn"}else{a="tw"}}if("sessionStorage" in window){sessionStorage.language=a}return a})();var NLArray=new Array();NLArray.cn={"html-title":"Google日历简易版","page-title":"Google日历简易版","page-intro":"<li>与Google Calendar同步</li><li>操作简捷</li><li>计划日程、写日记</li><li>所有数据直接保存在Google，不经过第三方，完全私密</li>","button-login":"登录","comment-url":"留言","login-message-text":'<strong>很抱歉!</strong> 暂时不支持您的浏览器，推荐使用最新版本的<a href="http://www.google.com/chrome">Chrome</a>或<a href="http://getfirefox.com/">Firefox</a>浏览器。',"timemin-label":"开始日期：","timemax-label":"结束日期：","button-refresh":" 刷新 ","button-refresh-label":"（一次最多返回30个事件。）","add-new-event-header":"添加新事件","new-event-start-label":'开始时间<span class="help-inline">（必填）</span>',"new-event-end-label":'结束时间<span class="help-inline">（必填）</span>',"new-event-title-label":'事件<span class="help-inline">（必填）</span>',"new-event-description-label":'备注<span class="help-inline">（选填）</span>',"new-event-button-cancel":"取消","button-insert-event":"保存","delete-event-message":"确认删除这个事件？","delete-event-button-cancel":"取消","button-confirm-event-delete":"确认","new-calendar-header":"新增一个日历","add-new-calendar-label":'名称<span class="help-inline">（必填）</span>',"new-calendar-button-cancel":"取消","button-confirm-calendar-create":"确认","no-authorization":"未获得授权。","please-login":"请正常登录。",prompt:"提示：","return":"[返回]",error:"返回结果有错误。","no-calendar":"您尚未创建任何日历。","add-new-calendar":"新增一个日历……","add-new-event":"[添加新事件]",logout:"[退出]","calendar-list":"日历列表 ",edit:"[修改]","delete":"[刪除]",loading:"正在加载，请稍候……","error-prompt":"出错了！","time-range":" 该时段","time-range-message":"是空的，添加一个新事件吧。","event-number":"事件总数：","no-calendar-error":"没有指定日历","delete-fail-error":"删除失败。","event-edit-header":"修改","create-calendar-error":"创建新日历失败。"};NLArray.tw={"html-title":"Google日曆簡易版","page-title":"Google日曆簡易版","page-intro":"<li>與Google Calendar同步</li><li>操作簡捷</li><li>計劃日程、寫日記</li><li>所有數據保存於Google，不經過第三方，完全私密</li>","button-login":"登錄","comment-url":"留言","login-message-text":'<strong>很抱歉!</strong> 暫時不支持您的瀏覽器，推薦使用最新版的<a href="http://www.google.com/chrome">Chrome</a>或<a href="http://getfirefox.com/">Firefox</a>瀏覽器。',"timemin-label":"開始日期：","timemax-label":"結束日期：","button-refresh":" 刷新 ","button-refresh-label":"（一次最多返回30個事件。）","add-new-event-header":"添加新事件","new-event-start-label":'開始時間<span class="help-inline">（必填）</span>',"new-event-end-label":'結束時間<span class="help-inline">（必填）</span>',"new-event-title-label":'事件<span class="help-inline">（必填）</span>',"new-event-description-label":'備註<span class="help-inline">（選填）</span>',"new-event-button-cancel":"取消","button-insert-event":"保存","delete-event-message":"確認刪除這個事件？","delete-event-button-cancel":"取消","button-confirm-event-delete":"確認","new-calendar-header":"新增一個日曆","add-new-calendar-label":'名稱<span class="help-inline">（必填）</span>',"new-calendar-button-cancel":"取消","button-confirm-calendar-create":"確認","no-authorization":"未獲得授權。","please-login":"請正常登錄。",prompt:"提示：","return":"[返回]",error:"返回結果有錯誤。","no-calendar":"您尚未創建任何日曆。","add-new-calendar":"新增一個日曆……","add-new-event":"[添加新事件]",logout:"[退出]","calendar-list":"日曆列表 ",edit:"[修改]","delete":"[刪除]",loading:"正在加載，請稍候……","error-prompt":"出錯了！","time-range":" 該時段","time-range-message":"是空的，添加一個新事件吧。","event-number":"事件總數：","no-calendar-error":"沒有指定日曆","delete-fail-error":"刪除失敗。","event-edit-header":"修改","create-calendar-error":"創建日曆失敗。"};NLArray.en={"html-title":"Easy Calendar","page-title":"Easy Calendar","page-intro":"<li>Synchronize your Google Calendar</li><li>Easy to use</li><li>To schedule your day, to write your journal</li><li>All data saved in Google, total privacy</li>","button-login":"Login","comment-url":"comment","login-message-text":'<strong>Sorry!</strong> Your browser is not supported. The newest version of <a href="http://www.google.com/chrome">Chrome</a> or <a href="http://getfirefox.com/">Firefox</a> is recommended.',"timemin-label":"Start Date:","timemax-label":"End Date:","button-refresh":" refresh ","button-refresh-label":"(Once return 30 events at most.)","add-new-event-header":"Add New Event","new-event-start-label":'Start Time<span class="help-inline"> (Required)</span>',"new-event-end-label":'End Time<span class="help-inline"> (Required)</span>',"new-event-title-label":'Summary<span class="help-inline"> (Required)</span>',"new-event-description-label":"Description","new-event-button-cancel":"Cancel","button-insert-event":"Save","delete-event-message":"Are you sure to delete this event?","delete-event-button-cancel":"Cancel","button-confirm-event-delete":"Confirm","new-calendar-header":"Add a new calendar","add-new-calendar-label":'Summary<span class="help-inline"> (Required)</span>',"new-calendar-button-cancel":"Cancel","button-confirm-calendar-create":"Save","no-authorization":"Didn't get authorization. ","please-login":"Please login. ",prompt:"Prompt: ","return":"[Return]",error:"Error returned. ","no-calendar":"You have not created any calendar. ","add-new-calendar":"Add a new calendar...","add-new-event":"[Add new event]",logout:"[Logout]","calendar-list":"Calendar list: ",edit:"[Edit]","delete":"[Delete]",loading:"Loading, please wait...","error-prompt":"Something wrong! ","time-range":" The time range","time-range-message":"is empty. You may add a new event. ","event-number":"Total Event(s): ","no-calendar-error":"no designated calendar","delete-fail-error":"Delete failed. ","event-edit-header":"Edit","create-calendar-error":"Creating new calendar failed. "};function NLChange(a){document.title=NLArray[a]["html-title"];$("#page-title").html(NLArray[a]["page-title"]);$("#page-intro").html(NLArray[a]["page-intro"]);$("#button-login").html(NLArray[a]["button-login"]);$("#comment-url").html(NLArray[a]["comment-url"]);$("#login-message-text").html(NLArray[a]["login-message-text"]);$("#timemin-label").html(NLArray[a]["timemin-label"]);$("#timemax-label").html(NLArray[a]["timemax-label"]);$("#button-refresh").html(NLArray[a]["button-refresh"]);$("#button-refresh-label").html(NLArray[a]["button-refresh-label"]);$("#add-new-event-header").html(NLArray[a]["add-new-event-header"]);$("#new-event-start-label").html(NLArray[a]["new-event-start-label"]);$("#new-event-title-label").html(NLArray[a]["new-event-title-label"]);$("#new-event-end-label").html(NLArray[a]["new-event-end-label"]);$("#new-event-description-label").html(NLArray[a]["new-event-description-label"]);$("#new-event-button-cancel").html(NLArray[a]["new-event-button-cancel"]);$("#button-insert-event").html(NLArray[a]["button-insert-event"]);$("#delete-event-message").html(NLArray[a]["delete-event-message"]);$("#delete-event-button-cancel").html(NLArray[a]["delete-event-button-cancel"]);$("#button-confirm-event-delete").html(NLArray[a]["button-confirm-event-delete"]);$("#new-calendar-header").html(NLArray[a]["new-calendar-header"]);$("#add-new-calendar-label").html(NLArray[a]["add-new-calendar-label"]);$("#new-calendar-button-cancel").html(NLArray[a]["new-calendar-button-cancel"]);$("#button-confirm-calendar-create").html(NLArray[a]["button-confirm-calendar-create"])}jQuery(document).on("show",".modal",function(){$(this).find(".modal-footer").width("94.8%");$(this).css("overflow","hidden")});jQuery(document).on("click","#button-login",function(){$("#modal-progress-bar").modal({keyboard:false,show:true});$("#modal-progress-bar .bar").width(10);var a=setInterval(function(){var d=$("#modal-progress-bar .bar");var b=$("#modal-progress-bar").width();if(d.width()>=b){clearInterval(a);$(".progress").removeClass("active")}else{d.width(d.width()+parseInt(b/30))}var c=parseInt((d.width()/b)*100);c=c>100?100:c;d.text(c+"%")},10);window.location=Calendar.getLoginUrl()});jQuery(document).on("click","#button-add-event",function(){Utility.addEvent()});jQuery(document).on("click","#dpmin",function(){$("#dpmin").datepicker("show")});jQuery(document).on("click","#dpmax",function(){$("#dpmax").datepicker("show")});jQuery(document).on("click","#dpstart",function(){$("#dpstart").datepicker("show")});jQuery(document).on("click","#dpend",function(){$("#dpend").datepicker("show")});jQuery(document).on("click","#button-insert-event",function(){if(!Utility.checkEventForm("#form-event-new")){return false}var a=Utility.insertEvent();Calendar.insertEvent(a);$("#event-new").modal("hide");Utility.refreshEventsList("add-new-event");return});jQuery(document).on("click",".button-delete",function(a){Utility.confirmEventDelete($(this).attr("data-id"))});jQuery(document).on("click","#button-confirm-event-delete",function(a){Utility.eventDelete($(this).attr("data-id"))});jQuery(document).on("click",".button-edit",function(a){Utility.confirmEventEdit($(this).data("id"))});jQuery(document).on("click","#button-confirm-calendar-create",function(){Utility.calendarCreate()});jQuery(document).on("click","#english-version",function(){if("sessionStorage" in window){sessionStorage.language="en"}var a=Utility.parseUrl();location=a.protocol+"//"+a.host+a.path;NLChange("en")});jQuery(document).on("click","#tradition-chinese-version",function(){if("sessionStorage" in window){sessionStorage.language="tw"}var a=Utility.parseUrl();location=a.protocol+"//"+a.host+a.path;NLChange("tw")});jQuery(document).on("click","#simplified-chinese-version",function(){if("sessionStorage" in window){sessionStorage.language="cn"}var a=Utility.parseUrl();location=a.protocol+"//"+a.host+a.path;NLChange("cn")});jQuery(document).ready(function(){NLChange(NL);var a=Utility.parseUrl();var f=Utility.parseHash(a.hash);if(f.state!=="login"){var c=$("#login-message");c.hide();var l=$("#login");if(!XMLHttpRequest||!("withCredentials" in new XMLHttpRequest())){l.hide();c.show();return 0}return}var b=$("#welcome");b.hide();var k=$("#content");k.show();if(!f.access_token){$("#content-result").hide();var m;if(f.error){m=NLArray[NL]["no-authorization"]+f.error}else{m=NLArray[NL]["please-login"]}m="<strong>"+NLArray[NL]["prompt"]+"</strong> "+m+'<a href="'+a.protocol+"//"+a.host+a.path+'">'+NLArray[NL]["return"]+"</a>";console.info(m);$("#content-message").show().find(".alert").addClass("alert-error").html(m);return}var j=f.access_token;Calendar.getCalendarList(j);var e=Calendar.listResponse;if(!e.items){var h=(e.error?e.error["message"]:NLArray[NL]["error"]);h="<strong>"+NLArray[NL]["prompt"]+"</strong>"+h+'<a href="'+a.protocol+"//"+a.host+a.path+'">'+NLArray[NL]["return"]+"</a>";$("#content-message").show().find(".alert").addClass("alert-error").html(h);return}Calendar.setListEntry(e.items);if(Calendar.listEntry.length===0){var g="<strong>"+NLArray[NL]["prompt"]+"</strong>"+NLArray[NL]["no-calendar"]+'<a href="'+a.protocol+"//"+a.host+a.path+'">'+NLArray[NL]["return"]+"</a>";$("#content-message").show().find(".alert").addClass("alert-info").html(g);return}var d="<select>";for(i in Calendar.listEntry){d=d+'<option value="'+Calendar.listEntry[i]["id"]+'" '+(Calendar.listEntry[i]["main"]?"selected":"")+" >"+Calendar.listEntry[i]["summary"]+"</option>"}d=d+'<option value="new">'+NLArray[NL]["add-new-calendar"]+"</option>";d=d+"</select>";d=d+'<div class="pull-right"><a class="text-error" id="button-add-event">'+NLArray[NL]["add-new-event"]+'</a> <a href="'+a.protocol+"//"+a.host+a.path+'">'+NLArray[NL]["logout"]+"</a></div>";$("#calendar-list").html(NLArray[NL]["calendar-list"]+d);$("#calendar-list").find("select").change(function(n){if(this.value==="new"){$("#modal-calendar-create").modal({keyboard:false,show:true,backdrop:"static"});$("#calendar-list option").each(function(){if(this.value===Calendar.currentCalendar.id){this.selected="selected"}});return}Utility.resetCurrentDate();Calendar.setCurrentCalendar(this.value);Utility.refreshEventsList()});if(!Calendar.currentCalendar){Calendar.setCurrentCalendar($("#calendar-list").find("option")[0].value)}Utility.resetCurrentDate();$("#calendar-date").find("button").click(function(n){n.preventDefault();Utility.refreshEventsList()});Utility.refreshEventsList()});var Calendar=(function(c,d){var g={};var f="";var b="https://accounts.google.com/o/oauth2/auth";var h=new Array();h.scope="https://www.googleapis.com/auth/calendar";h.redirect_uri=location.href.split("#")[0].split("?")[0];h.response_type="token";h.state="login";h.client_id="497007402964.apps.googleusercontent.com";var e=new Array();g.getLoginUrl=function(){for(x in h){e.push(x+"="+encodeURIComponent(h[x]))}f=b+"?"+e.join("&");return f};var a="";g.listResponse="";g.getCalendarList=function(m){var j="https://www.googleapis.com/calendar/v3/users/me/calendarList";a=m;var k=j+"?access_code="+m;var l=new XMLHttpRequest();l.open("GET",j,false);l.setRequestHeader("Authorization","Bearer "+m);l.onreadystatechange=function(n){if(l.readyState==4){g.listResponse=d.parseJSON(l.responseText)}};l.send(null)};g.listEntry=new Array();g.currentCalendar=new Object();g.setListEntry=function(k){for(i in k){var j=k[i];if(j.accessRole==="owner"){var l=0;if(j.id.substring(j.id.length-10)==="google.com"||l===1){j.main=0}else{j.main=1;g.currentCalendar=j;l=1}g.listEntry.push(j)}}};g.setCurrentCalendar=function(k){for(i in g.listEntry){var j=g.listEntry[i];if(j.id===k){g.currentCalendar=j}}};g.eventsList=new Object();g.currentTimemin="";g.currentTimemax="";g.getEventsList=function(m,n,j){var o="https://www.googleapis.com/calendar/v3/calendars/"+m+"/events";var l=o+"?maxResults=30";l=l+"&orderBy=startTime&singleEvents=True";g.currentTimemin=(new Date(n.split("-")[0],(n.split("-")[1]-1),n.split("-")[2],"00","00","00")).toISOString();g.currentTimemax=(new Date(j.split("-")[0],(j.split("-")[1]-1),j.split("-")[2],"23","59","59")).toISOString();l=l+"&timeMin="+g.currentTimemin;l=l+"&timeMax="+g.currentTimemax;l=l+"&fields=description%2Cetag%2Citems(creator%2Cdescription%2Cend%2Cetag%2ChtmlLink%2CiCalUID%2Cid%2Cstart%2Cstatus%2Csummary%2Cupdated)%2Ckind%2CnextPageToken%2Csummary%2Cupdated";var k=new XMLHttpRequest();k.open("GET",l,false);k.setRequestHeader("Authorization","Bearer "+a);k.onreadystatechange=function(p){if(k.readyState==4){g.eventsList=d.parseJSON(k.responseText)}};k.send(null)};g.eventsListError=false;g.eventsListErrorMessage="";g.eventsListNumber=0;g.doEventsList=function(j){if(j.error){g.eventsListError=true;g.eventsListErrorMessage=j.error["message"];return 0}if(!j.items&&j.kind!=="calendar#event"){g.eventsListError=false;g.eventsListNumber=0;return 0}if(j.items){g.eventsListError=false;g.eventsListNumber=j.items.length;return}g.eventsListNumber=1};g.showEventsList=function(l){var n="";for(var k=0;k<g.eventsListNumber;k++){var j=l[k];var m=g.parseDateTime(j.start["dateTime"]);n=n+'<div class="event-item" id="'+j.id+'">';n=n+'<div class="alert">';n=n+(k+1)+'.  <div class="pull-right"><a class="muted button-edit" data-id="'+j.id+'">'+NLArray[NL]["edit"]+'</a> <a class="muted button-delete" data-id="'+j.id+'">'+NLArray[NL]["delete"]+'</a> <a href="#content-result">↑</a> </div></div>';n=n+'<div class="well">';n=n+'<p class="text-info">';n=n+m.year+"-";n=n+m.month+"-";n=n+m.day+"";n=n+"<small>（"+m.hour+":"+m.minute+"）</small>";n=n+"</p>";n=n+"<blockquote>"+j.summary+"</blockquote>";if(j.description){n=n+"<blockquote>"+j.description+"</blockquote>"}n=n+"</div></div>"}return n};g.parseDateTime=function(l){var n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})([+-]\d{2}):(\d{2})$/;var k=n.exec(l);if(!k){var n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})Z$/;var k=n.exec(l)}var j=new Object();j.year=k[1];j.month=k[2];j.day=k[3];j.hour=k[4];j.minute=k[5];j.second=k[6];j.msec=k[7];j.tzHour=k[8];j.tzMin=k[9];j.tzOffset=new Date().getTimezoneOffset()+j.tzHour*60+j.tzMin;return j};g.insertEvent=function(j){if(j.id){var k="https://www.googleapis.com/calendar/v3/calendars/"+g.currentCalendar.id+"/events/"+j.id;var l=new XMLHttpRequest();l.open("PUT",k,false)}else{var k="https://www.googleapis.com/calendar/v3/calendars/"+g.currentCalendar.id+"/events";var l=new XMLHttpRequest();l.open("POST",k,false)}l.setRequestHeader("Content-Type","application/json");l.setRequestHeader("Authorization","Bearer "+a);if(j.id){delete j.id}var m=d.toJSON(j);l.onreadystatechange=function(n){if(l.readyState==4){g.eventsList=d.parseJSON(l.responseText);if(!g.eventsList.error&&!g.eventsList.items){g.eventsList={items:new Array(g.eventsList)}}}};l.send(m)};g.eventDeleteId="";g.eventDelete=function(k){var j="https://www.googleapis.com/calendar/v3/calendars/"+g.currentCalendar.id+"/events/"+k;var l=new XMLHttpRequest();l.open("DELETE",j,false);l.setRequestHeader("Authorization","Bearer "+a);l.onreadystatechange=function(m){if(l.readyState==4){if(l.status.toString().substr(0,1)==="2"){g.eventDeleteId=k}}};l.send(null)};g.calendarCreate=function(j){var k="https://www.googleapis.com/calendar/v3/calendars";var l=new XMLHttpRequest();l.open("POST",k,false);l.setRequestHeader("Content-Type","application/json");l.setRequestHeader("Authorization","Bearer "+a);var m=d.toJSON(j);l.onreadystatechange=function(n){if(l.readyState==4){g.listResponse=d.parseJSON(l.responseText)}};l.send(m);return};return g})(window,jQuery);var Utility=(function(b,c){var a=new Object();a.refreshEventsList=function(g){g=arguments[0]?arguments[0]:"select-event-list";if(g==="select-event-list"){var d="<strong>"+NLArray[NL]["prompt"]+"</strong>"+NLArray[NL]["loading"];c("#content-message").fadeIn(500).find(".alert").addClass("alert-info").html(d);Calendar.getEventsList(Calendar.currentCalendar.id,c("#timemin").val(),c("#timemax").val());c("#content-message").fadeOut(500).find(".alert").removeClass("alert-info")}var e=Calendar.eventsList;Calendar.doEventsList(e);if(Calendar.eventsListError){c("#calendar-events").html('<div class="alert alert-error"><strong>'+NLArray[NL]["error-prompt"]+"</strong> "+Calendar.eventsListErrorMessage+"</div>");return 1}if(Calendar.eventsListNumber===0){c("#calendar-events").html('<div class="alert alert-block"><strong>Ooops!</strong>'+NLArray[NL]["time-range"]+"（"+c("#timemin").val()+" - "+c("#timemax").val()+"）"+NLArray[NL]["time-range-message"]+"</div>");return 1}var f='<div class="alert alert-success">'+NLArray[NL]["event-number"]+'<span id="event-number">'+Calendar.eventsListNumber+"</span></div>";if(!e.items){f+=Calendar.showEventsList(new Array(e))}else{f+=Calendar.showEventsList(e.items)}c("#calendar-events").html(f)};a.resetCurrentDate=function(){var k=new Date();var l=k.getFullYear();var e=k.getMonth()+1;var g=k.getDate();var j=l+"-"+e+"-"+g;var f=k.getTime()/1000;var h=(f/(60*60*24)-30)*60*60*24;var d=(new Date(h*1000)).getFullYear()+"-"+((new Date(h*1000)).getMonth()+1)+"-"+(new Date(h*1000)).getDate();c("#timemin")[0].value=d;c("#dpmin").attr("data-date",d);c("#timemax")[0].value=j;c("#dpmax").attr("data-date",j)};a.addEvent=function(){if(!Calendar.currentCalendar.id){a.showStatusBar("error",NLArray[NL]["no-calendar-error"]);return}a.setNewEventTime();c("#momentstart").val(a.currentTime.hour+":"+a.currentTime.minute);c("#momentstart").timepicker({showMeridian:false,defaultTime:"value"});c("#momentend").val(new Date(a.currentTime.endStamp*1000).getHours()+":"+new Date(a.currentTime.endStamp*1000).getMinutes());c("#momentend").timepicker({showMeridian:false,defaultTime:"value"});c("#form-event-summary").val("");c("#form-event-description").val("");c("#event-new").find(".modal-header p").text(NLArray[NL]["add-new-event-header"]);c("#event-new").modal({keyboard:false,show:true,backdrop:"static"})};a.showStatusBar=function(d,f){var e="alert-"+d;f="<strong>"+NLArray[NL]["prompt"]+"</strong>"+f+'  <a href="'+a.url.protocol+"//"+a.url.host+a.url.path+'">'+NLArray[NL]["return"]+"</a>";c("#content-message").show().find(".alert").addClass(e).html(f)};a.url=new Object();a.parseUrl=function(){a.url.host=location.host;a.url.href=location.href;a.url.path=location.pathname;a.url.protocol=location.protocol;a.url.port=location.port;a.url.hash=location.hash;a.url.search=location.search;return a.url};a.hash=new Object();a.parseHash=function(f){var d=(f.substr(1)).split("&");for(i in d){var e=d[i].split("=")[0];var g=d[i].split("=")[1];a.hash[e]=g}return a.hash};a.currentTime=new Object();a.setNewEventTime=function(){a.currentTime.raw=new Date();a.currentTime.year=a.currentTime.raw.getFullYear();a.currentTime.month=a.currentTime.raw.getMonth()+1;a.currentTime.date=a.currentTime.raw.getDate();a.currentTime.hour=a.currentTime.raw.getHours();a.currentTime.minute=a.currentTime.raw.getMinutes();a.currentTime.second=a.currentTime.raw.getSeconds();var d=a.currentTime.year+"-"+a.currentTime.month+"-"+a.currentTime.date;a.currentTime.startStamp=a.currentTime.raw.getTime()/1000;a.currentTime.endStamp=a.currentTime.startStamp+60*60;var e=(new Date(a.currentTime.endStamp*1000)).getFullYear();e=e+"-"+((new Date(a.currentTime.endStamp*1000)).getMonth()+1);e=e+"-"+(new Date(a.currentTime.endStamp*1000)).getDate();c("#timestart")[0].value=d;c("#dpstart").data("date",d);c("#dpstart").attr("data-date",d);c("#timeend")[0].value=e;c("#dpend").data("date",e);c("#dpend").attr("data-date",e)};a.checkEventForm=function(g){var f=c(g);var e=f.find("input");var d=false;e.each(function(){var h=c(this);if(h.hasClass("error")){h.removeClass("error")}if(!h.val()){h.addClass("error");d=true}});if(d){return 0}return 1};a.insertEvent=function(){var e=new Object();var g=c("#timestart").val();var h=c("#momentstart").val();var f=c("#timeend").val();var d=c("#momentend").val();e.start={dateTime:a.setRFC3339(g,h)};e.end={dateTime:a.setRFC3339(f,d)};e.summary=c.trim(c("#form-event-summary").val());if(c.trim(c("#form-event-description").val())){e.description=c.trim(c("#form-event-description").val())}if(c("#button-insert-event").data("id")){i;e.id=c("#button-insert-event").data("id");c("#button-insert-event").data("id","")}return e};a.setRFC3339=function(e,h){var f=e.split("-");var j=f[0]+"-";j=j+a.padZero(f[1])+"-";j=j+a.padZero(f[2])+"T";var g=h.split(":");j=j+a.padZero(g[0])+":";j=j+a.padZero(g[1])+":";j=j+"00";var d=(new Date()).getTimezoneOffset();j=j+(d>0?"-":"+");j=j+a.padZero(Math.floor(Math.abs(d)/60))+":"+a.padZero(Math.abs(d)%60);return j};a.padZero=function(d){if((d*1)<10){d="0"+(d*1).toString()}return d};a.confirmEventDelete=function(d){c("#button-confirm-event-delete").attr("data-id",d);c("#modal-event-delete").modal("show")};a.eventDelete=function(d){Calendar.eventDelete(d);c("#modal-event-delete").modal("hide");if(Calendar.eventDeleteId===d){c("#"+d).hide("5000");c("#event-number").text(parseInt(c("#event-number").text())-1)}else{c("#content-message").fadeIn(1500).find(".alert").addClass("alert-info").html("<strong>"+NLArray[NL]["error-prompt"]+"</strong>"+NLArray[NL]["delete-fail-error"])}Calendar.eventDeleteId=""};a.confirmEventEdit=function(d){for(i in Calendar.eventsList.items){if(Calendar.eventsList.items[i]["id"]===d){var e=Calendar.eventsList.items[i];break}}if(!e){return}c("#event-new").find(".modal-header p").text(NLArray[NL]["event-edit-header"]);c("#timestart").val(e.start["dateTime"].split("T")[0]);c("#dpstart").data("date",e.start["dateTime"].split("T")[0]);c("#dpstart").attr("data-date",e.start["dateTime"].split("T")[0]);c("#timeend").val(e.end["dateTime"].split("T")[0]);c("#dpend").data("date",e.end["dateTime"].split("T")[0]);c("#dpend").attr("data-date",e.end["dateTime"].split("T")[0]);c("#momentstart").val(e.start["dateTime"].split("T")[1].substr(0,5));c("#momentstart").timepicker({showMeridian:false,defaultTime:"value"});c("#momentend").val(e.end["dateTime"].split("T")[1].substr(0,5));c("#momentend").timepicker({showMeridian:false,defaultTime:"value"});c("#form-event-summary").val(e.summary);c("#form-event-description").val(e.description);c("#button-insert-event").data("id",d);c("#event-new").modal({keyboard:false,show:true,backdrop:"static"})};a.calendarCreate=function(){if(!a.checkEventForm("#modal-calendar-create")){return false}c("#modal-calendar-create").modal("hide");var f=new Object();f.summary=c("#form-calendar-summary").val();var d=(new Date()).getTimezoneOffset();f.timeZone=(d>0?"-":"+")+a.padZero(Math.floor(Math.abs(d)/60))+":"+a.padZero(Math.abs(d)%60);Calendar.calendarCreate(f);var e=Calendar.listResponse;if(e.error||!e.id){c("#calendar-events").html('<div class="alert alert-block"><strong>'+NLArray[NL]["error-prompt"]+"</strong>"+NLArray[NL]["create-calendar-error"]+"</div>");return}e.main=1;Calendar.listEntry.forEach(function(h,g,j){Calendar.listEntry[g]["main"]=0});Calendar.listEntry.push(e);c('<option value="'+e.id+'">'+e.summary+"</option>").prependTo("#calendar-list select");a.resetCurrentDate();Calendar.setCurrentCalendar(e.id);c("#calendar-list option").each(function(){if(this.value===Calendar.currentCalendar.id){this.selected="selected"}});a.refreshEventsList()};return a})(window,jQuery);!function(c){var a=function(e,d){this.element=c(e);this.format=b.parseFormat(d.format||this.element.data("date-format")||"mm/dd/yyyy");this.picker=c(b.template).appendTo("body").on({click:c.proxy(this.click,this),mousedown:c.proxy(this.mousedown,this)});this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;if(this.isInput){this.element.on({focus:c.proxy(this.show,this),blur:c.proxy(this.hide,this),keyup:c.proxy(this.update,this)})}else{if(this.component){this.component.on("click",c.proxy(this.show,this))}else{this.element.on("click",c.proxy(this.show,this))}}this.viewMode=0;this.weekStart=d.weekStart||this.element.data("date-weekstart")||0;this.weekEnd=this.weekStart==0?6:this.weekStart-1;this.fillDow();this.fillMonths();this.update();this.showMode()};a.prototype={constructor:a,show:function(d){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();c(window).on("resize",c.proxy(this.place,this));if(d){d.stopPropagation();d.preventDefault()}if(!this.isInput){c(document).on("mousedown",c.proxy(this.hide,this))}this.update();this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide();c(window).off("resize",this.place);this.viewMode=0;this.showMode();if(!this.isInput){c(document).off("mousedown",this.hide)}this.setValue();this.element.trigger({type:"hide",date:this.date})},setValue:function(){var d=b.formatDate(this.date,this.format);if(!this.isInput){if(this.component){this.element.find("input").prop("value",d)}this.element.data("date",d)}else{this.element.prop("value",d)}},place:function(){var d=this.component?this.component.offset():this.element.offset();this.picker.css({top:d.top+this.height,left:d.left})},update:function(){this.date=b.parseDate(this.isInput?this.element.prop("value"):this.element.data("date"),this.format);this.viewDate=new Date(this.date);this.fill()},fillDow:function(){var d=this.weekStart;var e="<tr>";while(d<this.weekStart+7){e+='<th class="dow">'+b.dates.daysMin[(d++)%7]+"</th>"}e+="</tr>";this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){var e="";var d=0;while(d<12){e+='<span class="month">'+b.dates.monthsShort[d++]+"</span>"}this.picker.find(".datepicker-months td").append(e)},fill:function(){var o=new Date(this.viewDate),p=o.getFullYear(),n=o.getMonth(),f=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(b.dates.months[n]+" "+p);var j=new Date(p,n-1,28,0,0,0,0),q=b.getDaysInMonth(j.getFullYear(),j.getMonth());j.setDate(q);j.setDate(q-(j.getDay()-this.weekStart+7)%7);var l=new Date(j);l.setDate(l.getDate()+42);l=l.valueOf();html=[];var h;while(j.valueOf()<l){if(j.getDay()==this.weekStart){html.push("<tr>")}h="";if(j.getMonth()<n){h+=" old"}else{if(j.getMonth()>n){h+=" new"}}if(j.valueOf()==f){h+=" active"}html.push('<td class="day'+h+'">'+j.getDate()+"</td>");if(j.getDay()==this.weekEnd){html.push("</tr>")}j.setDate(j.getDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(html.join(""));var m=this.date.getFullYear();var e=this.picker.find(".datepicker-months").find("th:eq(1)").text(p).end().find("span").removeClass("active");if(m==p){e.eq(this.date.getMonth()).addClass("active")}html="";p=parseInt(p/10,10)*10;var g=this.picker.find(".datepicker-years").find("th:eq(1)").text(p+"-"+(p+9)).end().find("td");p-=1;for(var k=-1;k<11;k++){html+='<span class="year'+(k==-1||k==10?" old":"")+(m==p?" active":"")+'">'+p+"</span>";p+=1}g.html(html)},click:function(j){j.stopPropagation();j.preventDefault();var h=c(j.target).closest("span, td, th");if(h.length==1){switch(h[0].nodeName.toLowerCase()){case"th":switch(h[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+b.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+b.modes[this.viewMode].navFnc].call(this.viewDate)+b.modes[this.viewMode].navStep*(h[0].className=="prev"?-1:1));this.fill();break}break;case"span":if(h.is(".month")){var g=h.parent().find("span").index(h);this.viewDate.setMonth(g)}else{var f=parseInt(h.text(),10)||0;this.viewDate.setFullYear(f)}this.showMode(-1);this.fill();break;case"td":if(h.is(".day")){var d=parseInt(h.text(),10)||1;var g=this.viewDate.getMonth();if(h.is(".old")){g-=1}else{if(h.is(".new")){g+=1}}var f=this.viewDate.getFullYear();this.date=new Date(f,g,d,0,0,0,0);this.viewDate=new Date(f,g,d,0,0,0,0);this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date})}break}}},mousedown:function(d){d.stopPropagation();d.preventDefault()},showMode:function(d){if(d){this.viewMode=Math.max(0,Math.min(2,this.viewMode+d))}this.picker.find(">div").hide().filter(".datepicker-"+b.modes[this.viewMode].clsName).show()}};c.fn.datepicker=function(d){return this.each(function(){var g=c(this),f=g.data("datepicker"),e=typeof d=="object"&&d;if(!f){g.data("datepicker",(f=new a(this,c.extend({},c.fn.datepicker.defaults,e))))}if(typeof d=="string"){f[d]()}})};c.fn.datepicker.defaults={};c.fn.datepicker.Constructor=a;var b={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(d){return(((d%4===0)&&(d%100!==0))||(d%400===0))},getDaysInMonth:function(d,e){return[31,(b.isLeapYear(d)?29:28),31,30,31,30,31,31,30,31,30,31][e]},parseFormat:function(f){var e=f.match(/[.\/-].*?/),d=f.split(/\W+/);if(!e||!d||d.length==0){throw new Error("Invalid date format.")}return{separator:e,parts:d}},parseDate:function(d,h){var g=d.split(h.separator),d=new Date(1970,1,1,0,0,0),j;if(g.length==h.parts.length){for(var f=0,e=h.parts.length;f<e;f++){j=parseInt(g[f],10)||1;switch(h.parts[f]){case"dd":case"d":d.setDate(j);break;case"mm":case"m":d.setMonth(j-1);break;case"yy":d.setFullYear(2000+j);break;case"yyyy":d.setFullYear(j);break}}}return d},formatDate:function(d,g){var h={d:d.getDate(),m:d.getMonth()+1,yy:d.getFullYear().toString().substring(2),yyyy:d.getFullYear()};h.dd=(h.d<10?"0":"")+h.d;h.mm=(h.m<10?"0":"")+h.m;var d=[];for(var f=0,e=g.parts.length;f<e;f++){d.push(h[g.parts[f]])}return d.join(g.separator)},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};b.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+b.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+b.headTemplate+b.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+b.headTemplate+b.contTemplate+"</table></div></div>"}(window.jQuery);!function(b){var a=function(d,c){this.$element=b(d);this.options=b.extend({},b.fn.timepicker.defaults,c,this.$element.data());this.minuteStep=this.options.minuteStep||this.minuteStep;this.secondStep=this.options.secondStep||this.secondStep;this.showMeridian=this.options.showMeridian||this.showMeridian;this.showSeconds=this.options.showSeconds||this.showSeconds;this.showInputs=this.options.showInputs||this.showInputs;this.disableFocus=this.options.disableFocus||this.disableFocus;this.template=this.options.template||this.template;this.modalBackdrop=this.options.modalBackdrop||this.modalBackdrop;this.defaultTime=this.options.defaultTime||this.defaultTime;this.open=false;this.init()};a.prototype={constructor:a,init:function(){if(this.$element.parent().hasClass("input-append")){this.$element.parent(".input-append").find(".add-on").on("click",b.proxy(this.showWidget,this));this.$element.on({focus:b.proxy(this.highlightUnit,this),click:b.proxy(this.highlightUnit,this),keypress:b.proxy(this.elementKeypress,this),blur:b.proxy(this.blurElement,this)})}else{if(this.template){this.$element.on({focus:b.proxy(this.showWidget,this),click:b.proxy(this.showWidget,this),blur:b.proxy(this.blurElement,this)})}else{this.$element.on({focus:b.proxy(this.highlightUnit,this),click:b.proxy(this.highlightUnit,this),keypress:b.proxy(this.elementKeypress,this),blur:b.proxy(this.blurElement,this)})}}this.$widget=b(this.getTemplate()).appendTo("body");this.$widget.on("click",b.proxy(this.widgetClick,this));if(this.showInputs){this.$widget.find("input").on({click:function(){this.select()},keypress:b.proxy(this.widgetKeypress,this),change:b.proxy(this.updateFromWidgetInputs,this)})}this.setDefaultTime(this.defaultTime)},showWidget:function(c){c.stopPropagation();c.preventDefault();if(this.open){return}this.$element.trigger("show");if(this.disableFocus){this.$element.blur()}var d=b.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.updateFromElementVal();b("html").trigger("click.timepicker.data-api").one("click.timepicker.data-api",b.proxy(this.hideWidget,this));if(this.template==="modal"){this.$widget.modal("show").on("hidden",b.proxy(this.hideWidget,this))}else{this.$widget.css({top:d.top+d.height,left:d.left});if(!this.open){this.$widget.addClass("open")}}this.open=true;this.$element.trigger("shown")},hideWidget:function(){this.$element.trigger("hide");if(this.template==="modal"){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}this.open=false;this.$element.trigger("hidden")},widgetClick:function(d){d.stopPropagation();d.preventDefault();var c=b(d.target).closest("a").data("action");if(c){this[c]();this.update()}},widgetKeypress:function(d){var c=b(d.target).closest("input").attr("name");switch(d.keyCode){case 9:if(this.showMeridian){if(c=="meridian"){this.hideWidget()}}else{if(this.showSeconds){if(c=="second"){this.hideWidget()}}else{if(c=="minute"){this.hideWidget()}}}break;case 27:this.hideWidget();break;case 38:switch(c){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break;case 40:switch(c){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break}},elementKeypress:function(d){var c=this.$element.get(0);switch(d.keyCode){case 0:break;case 9:this.updateFromElementVal();if(this.showMeridian){if(this.highlightedUnit!="meridian"){d.preventDefault();this.highlightNextUnit()}}else{if(this.showSeconds){if(this.highlightedUnit!="second"){d.preventDefault();this.highlightNextUnit()}}else{if(this.highlightedUnit!="minute"){d.preventDefault();this.highlightNextUnit()}}}break;case 27:this.updateFromElementVal();break;case 37:this.updateFromElementVal();this.highlightPrevUnit();break;case 38:switch(this.highlightedUnit){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break;case 39:this.updateFromElementVal();this.highlightNextUnit();break;case 40:switch(this.highlightedUnit){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break}if(d.keyCode!==0&&d.keyCode!==8&&d.keyCode!==9&&d.keyCode!==46){d.preventDefault()}},setValues:function(e){if(this.showMeridian){var c=e.split(" ");var d=c[0].split(":");this.meridian=c[1]}else{var d=e.split(":")}this.hour=parseInt(d[0],10);this.minute=parseInt(d[1],10);this.second=parseInt(d[2],10);if(isNaN(this.hour)){this.hour=0}if(isNaN(this.minute)){this.minute=0}if(this.showMeridian){if(this.hour>12){this.hour=12}else{if(this.hour<1){this.hour=1}}if(this.meridian=="am"||this.meridian=="a"){this.meridian="AM"}else{if(this.meridian=="pm"||this.meridian=="p"){this.meridian="PM"}}if(this.meridian!="AM"&&this.meridian!="PM"){this.meridian="AM"}}else{if(this.hour>=24){this.hour=23}else{if(this.hour<0){this.hour=0}}}if(this.minute<0){this.minute=0}else{if(this.minute>=60){this.minute=59}}if(this.showSeconds){if(isNaN(this.second)){this.second=0}else{if(this.second<0){this.second=0}else{if(this.second>=60){this.second=59}}}}this.updateElement();this.updateWidget()},setMeridian:function(c){if(c=="a"||c=="am"||c=="AM"){this.meridian="AM"}else{if(c=="p"||c=="pm"||c=="PM"){this.meridian="PM"}else{this.updateWidget()}}this.updateElement()},setDefaultTime:function(e){if(e){if(e==="current"){var c=new Date();var d=c.getHours();var g=Math.floor(c.getMinutes()/this.minuteStep)*this.minuteStep;var h=Math.floor(c.getSeconds()/this.secondStep)*this.secondStep;var f="AM";if(this.showMeridian){if(d===0){d=12}else{if(d>=12){if(d>12){d=d-12}f="PM"}else{f="AM"}}}this.hour=d;this.minute=g;this.second=h;this.meridian=f}else{if(e==="value"){this.setValues(this.$element.val())}else{this.setValues(e)}}this.update()}else{this.hour=0;this.minute=0;this.second=0}},formatTime:function(c,f,d,e){c=c<10?"0"+c:c;f=f<10?"0"+f:f;d=d<10?"0"+d:d;return c+":"+f+(this.showSeconds?":"+d:"")+(this.showMeridian?" "+e:"")},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},setTime:function(c){this.setValues(c);this.update()},update:function(){this.updateElement();this.updateWidget()},blurElement:function(){this.highlightedUnit=undefined;this.updateFromElementVal()},updateElement:function(){var c=this.getTime();this.$element.val(c).change();switch(this.highlightedUnit){case"hour":this.highlightHour();break;case"minute":this.highlightMinute();break;case"second":this.highlightSecond();break;case"meridian":this.highlightMeridian();break}},updateWidget:function(){if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(this.hour<10?"0"+this.hour:this.hour);this.$widget.find("input.bootstrap-timepicker-minute").val(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(this.hour);this.$widget.find("span.bootstrap-timepicker-minute").text(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromElementVal:function(d){var c=this.$element.val();if(c){this.setValues(c);this.updateWidget()}},updateFromWidgetInputs:function(){var c=b("input.bootstrap-timepicker-hour",this.$widget).val()+":"+b("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+b("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+b("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setValues(c)},getCursorPosition:function(){var d=this.$element.get(0);if("selectionStart" in d){return d.selectionStart}else{if(document.selection){d.focus();var e=document.selection.createRange();var c=document.selection.createRange().text.length;e.moveStart("character",-d.value.length);return e.text.length-c}}},highlightUnit:function(){var c=this.$element.get(0);this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}break;case"second":this.highlightMeridian();break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){this.highlightedUnit="hour";this.$element.get(0).setSelectionRange(0,2)},highlightMinute:function(){this.highlightedUnit="minute";this.$element.get(0).setSelectionRange(3,5)},highlightSecond:function(){this.highlightedUnit="second";this.$element.get(0).setSelectionRange(6,8)},highlightMeridian:function(){this.highlightedUnit="meridian";if(this.showSeconds){this.$element.get(0).setSelectionRange(9,11)}else{this.$element.get(0).setSelectionRange(6,8)}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.toggleMeridian()}else{if(this.hour===12){return this.hour=1}}}if(this.hour===23){return this.hour=0}this.hour=this.hour+1},decrementHour:function(){if(this.showMeridian){if(this.hour===1){return this.hour=12}else{if(this.hour===12){this.toggleMeridian()}}}if(this.hour===0){return this.hour=23}this.hour=this.hour-1},incrementMinute:function(){var c=this.minute+this.minuteStep-(this.minute%this.minuteStep);if(c>59){this.incrementHour();this.minute=c-60}else{this.minute=c}},decrementMinute:function(){var c=this.minute-this.minuteStep;if(c<0){this.decrementHour();this.minute=c+60}else{this.minute=c}},incrementSecond:function(){var c=this.second+this.secondStep-(this.second%this.secondStep);if(c>59){this.incrementMinute();this.second=c-60}else{this.second=c}},decrementSecond:function(){var c=this.second-this.secondStep;if(c<0){this.decrementMinute();this.second=c+60}else{this.second=c}},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM";this.update()},getTemplate:function(){if(this.options.templates[this.options.template]){return this.options.templates[this.options.template]}if(this.showInputs){var g='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>';var d='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>';var c='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>';var f='<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>'}else{var g='<span class="bootstrap-timepicker-hour"></span>';var d='<span class="bootstrap-timepicker-minute"></span>';var c='<span class="bootstrap-timepicker-second"></span>';var f='<span class="bootstrap-timepicker-meridian"></span>'}var h='<table class="'+(this.showSeconds?"show-seconds":"")+" "+(this.showMeridian?"show-meridian":"")+'"><tr><td><a href="#" data-action="incrementHour"><i class="icon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="icon-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="icon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+g+'</td> <td class="separator">:</td><td>'+d+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+c+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+f+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="icon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="icon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="icon-chevron-down"></i></a></td>':"")+"</tr></table>";var e;switch(this.options.template){case"modal":e='<div class="bootstrap-timepicker modal hide fade in" style="top: 30%; margin-top: 0; width: 200px; margin-left: -100px;" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">×</a><h3>Pick a Time</h3></div><div class="modal-content">'+h+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a></div></div>';break;case"dropdown":e='<div class="bootstrap-timepicker dropdown-menu">'+h+"</div>";break}return e}};b.fn.timepicker=function(c){return this.each(function(){var f=b(this),e=f.data("timepicker"),d=typeof c=="object"&&c;if(!e){f.data("timepicker",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.timepicker.defaults={minuteStep:15,secondStep:15,disableFocus:false,defaultTime:"current",showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",modalBackdrop:false,templates:{}};b.fn.timepicker.Constructor=a}(window.jQuery);(function($){var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var type=typeof o;if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return""+o}if(type==="string"){return $.quoteString(o)}if(type==="object"){if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(o.constructor===Date){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}if(o.constructor===Array){var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i])||"null")}return"["+ret.join(",")+"]"}var name,val,pairs=[];for(var k in o){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type==="function"||type==="undefined"){continue}val=$.toJSON(o[k]);pairs.push(name+":"+val)}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(src){return eval("("+src+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(src){var filtered=src.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+src+")")}else{throw new SyntaxError("Error parsing JSON, source is not valid.")}};$.quoteString=function(string){if(string.match(escapeable)){return'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+string+'"'}})(jQuery);
