
<!DOCTYPE html>
<html>
  <head>
    <title>CalMapIt</title>
    <link rel="stylesheet" href="css/ol.css" />
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyCDyuMEpvjNHZS8ACf1rJPhxMOODrfJyL4&sensor=true&libraries=panoramio,weather,places,geocoder"></script>
	<script type="text/javascript" src="http://www.google.com/jsapi"></script> 
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
    <script src="closure/goog/base.js"></script>
	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
	<script type='text/javascript' src='http://code.jquery.com/jquery-1.4.3.js'></script>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.4/jquery-ui.js"></script>
	<link rel="stylesheet" type="text/css" href="css/jquery.countdown.css"> 
	<script type="text/javascript" src="js/jquery.plugin.js"></script> 
	<script type="text/javascript" src="js/jquery.countdown.js"></script>
    <script type="text/javascript" src="js/css_browser_selector.js"></script>
    <script type="text/javascript" src="js/jquery.validate.js"></script>
    <script type="text/javascript" src="js/jquery.countdown.min.js"></script>
    <script type="text/javascript" src="js/jquery.easing-1.3.js"></script>
    <script type="text/javascript" src="js/jquery.spritely.js"></script>
    <script type="text/javascript" src="js/jquery.pageslide.min.js"></script>
    <script type="text/javascript" src="js/jquery.cycle.all.min.js"></script>
    <script type="text/javascript" src="js/jquery.maximage.min.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
	
    <link href="css/jquery.maximage.min.css" rel="stylesheet">
    <link href="css/jquery.pageslide.css" rel="stylesheet">
    <link href="css/jquery.countdown.css" rel="stylesheet">
	<link href="css/shmik.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/dot-luv/jquery-ui.css"/>
    <script type="text/javascript" src="js/infobubble.js"></script>
	<script type="text/javascript" src="https://geoxml3.googlecode.com/svn/branches/polys/geoxml3.js"></script>
	<script type="text/javascript">
		  var script = '<script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.6/src/markerclusterer';
		  if (document.location.search.indexOf('compiled') !== -1) {
			script += '_packed';
		  }
		  script += '.js"><' + '/script>';
		  document.write(script);
	</script>
	<!-- Font Awesome icons -->
    <link rel="stylesheet" href="http://weloveiconfonts.com/api/?family=fontawesome">
    <style>
       
    </style>
	<script type="text/javascript" src="js/ate.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" />
    <script type="text/javascript" src="js/ol.js"></script>
	<script>
		goog.require('goog.dom');
		goog.require('goog.ui.Component');
		goog.require('goog.ui.TwoThumbSlider');
	</script>
	<script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript"><!-- This is the original open layer code -- mostley controls layout-->
		function getHeight() {
				
				var winheight = $(window).height() - 220 ;
				var map_height = $("#map_canvas").css("height");
				var tablechange = $(window).height() - 150;
				var table_height = $('#rtSide').height();
				
				
				$('#tableheight').height( tablechange);
				$('#rtSide').height( winheight );
				$('#directionStepsRight').height( tablechange);
				$('#taskpane').height( tablechange);
			}
			
      function applyMargins() {
        var leftToggler = $(".mini-submenu-left");
        var rightToggler = $(".mini-submenu-right");
        if (leftToggler.is(":visible")) {
          $("#map_canvas .ol-zoom")
            .css("margin-left", 0)
            .removeClass("zoom-top-opened-sidebar")
            .addClass("zoom-top-collapsed");
        } else {
          $("#map_canvas .ol-zoom")
            .css("margin-left", $(".sidebar-left").width())
            .removeClass("zoom-top-opened-sidebar")
            .removeClass("zoom-top-collapsed");
        }
        if (rightToggler.is(":visible")) {
          $("#map_canvas .ol-rotate")
            .css("margin-right", 0)
            .removeClass("zoom-top-opened-sidebar")
            .addClass("zoom-top-collapsed");
        } else {
          $("#map_canvas .ol-rotate")
            .css("margin-right", $(".sidebar-right").width())
            .removeClass("zoom-top-opened-sidebar")
            .removeClass("zoom-top-collapsed");
        }
		getHeight();
      }

      function isConstrained() {
        return $("div.mid").width() == $(window).width();
      }

      function applyInitialUIState() {
        if (isConstrained()) {
          $(".sidebar-left .sidebar-body").fadeOut('slide');
          $(".sidebar-right .sidebar-body").fadeOut('slide');
          $('.mini-submenu-left').fadeIn();
          $('.mini-submenu-right').fadeIn();
		  $('.panel-collapse collapse in').accordion({  active: false });
        }
      }
	  
		function closeall() {
			//if (isConstrained()) {
				$('.sidebar-left .sidebar-body').fadeOut();
				$('#legend').fadeOut();
				$('.sidebar-right .sidebar-body').fadeOut();
				$('.mini-submenu-left').fadeIn();
				$('.mini-submenu-right').fadeIn();
				$('.panel-collapse collapse in').accordion({  active: false });
			//}
		  }
		  
		  function showLegend() {
			 $('#legend').toggle();
		  }
		


      $(function(){
        $('.sidebar-left .slide-submenu').on('click',function() {
          var thisEl = $(this);
          thisEl.closest('.sidebar-body').fadeOut('slide',function(){
            $('.mini-submenu-left').fadeIn();
            applyMargins();
          });
        });

        $('.mini-submenu-left').on('click',function() {
          var thisEl = $(this);
          $('.sidebar-left .sidebar-body').toggle('slide');
          thisEl.hide();
          applyMargins();
        });

        $('.sidebar-right .slide-submenu').on('click',function() {
          var thisEl = $(this);
          thisEl.closest('.sidebar-body').fadeOut('slide',function(){
            $('.mini-submenu-right').fadeIn();
            applyMargins();
          });
        });

        $('.mini-submenu-right').on('click',function() {
          var thisEl = $(this);
          $('.sidebar-right .sidebar-body').toggle('slide');
          thisEl.hide();
          applyMargins();
        });
		
        $(window).on("resize", applyMargins);

       /* var map = new ol.Map({
          target: "map_canvas",
          layers: [
            new ol.layer.Tile({
              source: new ol.source.OSM()
            })
          ],
          view: new ol.View({
            center: [0, 0],
            zoom: 2
          })
        });*/
        applyInitialUIState();
        applyMargins();
      });
    </script>
	  <script> 
  ;(function(exports) {
  var MS_IN_MINUTES = 60 * 1000;

  var formatTime = function(date) {
    return date.toISOString().replace(/-|:|\.\d+/g, '');
  };

  var calculateEndTime = function(event) {
    return event.end ?
      formatTime(event.end) :
      formatTime(new Date(event.start.getTime() + (event.duration * MS_IN_MINUTES)));
  };

  var calendarGenerators = {
    google: function(event) {
      var startTime = formatTime(event.start);
      var endTime = calculateEndTime(event);

      var href = encodeURI([
        'https://www.google.com/calendar/render',
        '?action=TEMPLATE',
        '&text=' + (event.title || ''),
        '&dates=' + (startTime || ''),
        '/' + (endTime || ''),
        '&details=' + (event.description || ''),
        '&location=' + (event.address || ''),
        '&sprop=&sprop=name:'
      ].join(''));
      return '<a class="icon-google" target="_blank" href="' +
        href + '"></a>';
    },

    yahoo: function(event) {
      var eventDuration = event.end ?
        ((event.end.getTime() - event.start.getTime())/ MS_IN_MINUTES) :
        event.duration;

      // Yahoo dates are crazy, we need to convert the duration from minutes to hh:mm
      var yahooHourDuration = eventDuration < 600 ?
        '0' + Math.floor((eventDuration / 60)) :
        Math.floor((eventDuration / 60)) + '';

      var yahooMinuteDuration = eventDuration % 60 < 10 ?
        '0' + eventDuration % 60 :
        eventDuration % 60 + '';

      var yahooEventDuration = yahooHourDuration + yahooMinuteDuration;

      // Remove timezone from event time
      var st = formatTime(new Date(event.start - (event.start.getTimezoneOffset() *
                                                  MS_IN_MINUTES))) || '';

      var href = encodeURI([
        'http://calendar.yahoo.com/?v=60&view=d&type=20',
        '&title=' + (event.title || ''),
        '&st=' + st,
        '&dur=' + (yahooEventDuration || ''),
        '&desc=' + (event.description || ''),
        '&in_loc=' + (event.address || '')
      ].join(''));

      return '<a class="icon-yahoo" target="_blank" href="' +
        href + '">Yahoo! Calendar</a>';
    },

    ics: function(event, eClass, calendarName) {
      var startTime = formatTime(event.start);
      var endTime = calculateEndTime(event);

      var href = encodeURI(
        'data:text/calendar;charset=utf8,' + [
          'BEGIN:VCALENDAR',
          'VERSION:2.0',
          'BEGIN:VEVENT',
          'URL:' + document.URL,
          'DTSTART:' + (startTime || ''),
          'DTEND:' + (endTime || ''),
          'SUMMARY:' + (event.title || ''),
          'DESCRIPTION:' + (event.description || ''),
          'LOCATION:' + (event.address || ''),
          'END:VEVENT',
          'END:VCALENDAR'].join('\n'));

      return '<a class="' + eClass + '" target="_blank" href="' +
        href + '">' + calendarName + ' Calendar</a>';
    },

    ical: function(event) {
      return this.ics(event, 'icon-ical', 'iCal');
    },

    outlook: function(event) {
      return this.ics(event, 'icon-outlook', 'Outlook');
    }
  };

  var generateCalendars = function(event) {
    return {
      google: calendarGenerators.google(event)
    };
  };

  // Create CSS
  var addCSS = function() {
    if (!document.getElementById('ouical-css')) {
		if (document.getElementsByClassName('my-id')) {
			document.getElementsByClassName('new-cal').removeChild('my-id');
		}
		//document.getElementById('addeventlink').remove();
      document.getElementsByTagName('head')[0].appendChild(generateCSS());
    }
  };

  var generateCSS = function() {
    var styles = document.createElement('style');
    styles.id = 'ouical-css';

    styles.innerHTML = "#"
	+ "a{display:inline-block;width:20px;float:left;white-space: nowrap; position:absolute;}input[type=checkbox].add-to-calendar-checkbox{position:absolute;top:-9999px;left:-9999px}.add-to-calendar-checkbox~"
	+ "a:before{width:16px;height:16px;display:inline-block;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAAAQCAYAAACIoli7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0MzJCRDU2NUE1MDIxMUUyOTY1Q0EwNTkxNEJDOUIwNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0MzJCRDU2NkE1MDIxMUUyOTY1Q0EwNTkxNEJDOUIwNCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzMkJENTYzQTUwMjExRTI5NjVDQTA1OTE0QkM5QjA0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQzMkJENTY0QTUwMjExRTI5NjVDQTA1OTE0QkM5QjA0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+1Gcb3QAACh1JREFUeNrEWAtwVNUZ/u7d9yvZJBtMIC8eBhIKMkQIhqIBKirWwpSW0dahCir1gQhWg2XKjNRqR7AjQ6QjglBFRIW20KmC0KRYjRYMCZGHGEjIY0Oy2U32lX3d3Xv6nxuSbEJCQNvpn/n33POfxz33u9//uBGaBQFcMhgrpGYC6ddk+zfiZKgxsvOG4buJMGATNtzcq4l+WStbsGgpvOiELpgBWetGQGNCstSGkKwH1Ek04oVNFUZQsEAjedCg0iBRVivrP737CL+H8Na7f7lpRFa2cOfMqdUn9n3ARGc7NLEYJj62Qle6Z3/ZlATt82mINV4QVPV33HVXmK/1bRgPvst60vzXgJzZZ84UlOfnV1L/YvwhBxk7Q7quZ3zZLrvSivRy+PtR0Y8oUit2P7+aWm5TifxahErVPWfd/JRBQaNVjA2CIhsecEwIubHzB3+CQWNDNBCCyuiEC6NgpV3agkCszYWknBTInjAMFh20HAo1/QQFVM7Kw9aly7D1ze2iJEemhbu8Mzf++rkVNGMkaS7puKadb0yubGscp/Wa3rc0nNXVJ6RsJvsaUhmXt5oyZv36e4o//hi1tbUonjWrYNTs2QXxhywuL+8bmzevoG7dOu3gj8Po2MIVZGIcAw6TcPma0YV4JfXYEBiy/rbeqZcv+i1tEbIgagzgOAWMerT5MvDuXgfOH6vAsRoRgVAqHOp2TMrX4dYfFmLhVAHTRqtgkn0QQ3W0anZK+UsvzJe/qflxi2d04a3u9iJWdngUHd/I33KEyJEoqBE2mqCxGBCqq//p8idWvPh66Wa35ZlzUIcAnez3w+n14uwDD8CalYWo293vYePH+Fy+Jn58289HKu2rpbux9KF7EY4yfHroAHKL5iv2w/v2Ye7CBfBHBLRWHYJ54rzrCQcsDtx+YA4MAbyTqjsHLfLIrWWcChjwu/XHUVnuxrGDC2G2AdwnnKQNXwOLHnwFH4da8VnZBpg0ZqgcOgJMfKa+oqJkTDQMX3or3GF/khgJQ9TroDInQENq9rjItaNwqUWkeDoy0wtmTKYt/8XPpg4wZpADARTt2YOJx45Bo9PBlZEBy86dvQedPGkSxmZnw5SQAD6Xrxns6XWmYO+1x3e+n52D2WM3Y96w6F0F1F4wBwsBprBEv+0wIQO7Xj2HC0ercLbiEdi0zYgyAk1OgFUQccONwP5dyxELNMCQ5Cfq0YZpekgCpMZgENPvmIc5KckEm4gL7+9BrL0d1rFjYSGGGkePgyWX4qU1CQW3zVG5ztV+n25aQRpVGBojkFpWroTBaAQ/TpD6eput3xOZzWaKEjL43IEM3frHLZD8XtyQasXhdzbDbNTCJjN89tftvfaW8jd67fPyzP3jRBzThGGYKgwxrcceM2eyYDQNG9+8iAMfHsaRXY/AouV4qRAS9NCrmmkjKxBKwOQsM8X0iQhQkpK1IUiiBxq1+oLfaPJJXo8lEOyCJtGKScsfhTYpGYItFTUXG9DY2oqQw4UnFi5SGF/2zfkialQcUJ66V7PrFL5mQhwgXGRZZjv+8ALzBGPM4YuyA9s3sFMtIUW5/Xx7hNU0+RU7X7OM5bFlJxSQ2ODR+ArlIUy5HDjW04y+t5UrC9J5Vm5tYxkz/s5YF3WiESYzP2MRmbmp6+EH9vuZxM9N9iBz0ViUHbclsPuX/GJ2SUnJeX+LnUW6/MqzHTp6lL29dy9rtLewx598kpWsWcPuu+8+Fo1GlfG9+/bZn1q1Kk1JzHQSlUxHjBL7rkX5XL5mMBQks7WvY0vvZ3d4pW63j7Nfo/QDfYCbs3iGa6UORYMUP/92qhoYE4VsdNCoDEEyUYqnhBIDEmJ8hZYenKdmETH6468pWa3GJbvdHpKiTWpio4YSz7Hjx7Hu2Wdx9KOPkDkyHaWbNiE/Lw+LFy+makWlHCInOyc9MyOTJ3JRzcEhnCHHYtf0dCJtwrrp3Suvv/UGvO4uWBLN2L9/N7xeFzyedrS43+q1F401DQdaP+8Vrg1ppcRS3t+DDVQe9dhFqF3JiHTaIYaTyL2jYIld8IsGWCQRTB+GoCcgiU5q2QCD6KNFdQjrM1FVXeUYd+PYxg6nE+np6ZiYn48dO3Zg7dq1iEQi0Gq1KKeqh1h82T2BURkZQlpa2kzqHuJ1qEph3zCAPnVyDao8X6EgeQowANDlSx7mfo9t772NBQt+pmT5T468jgmFS5TxiqPvdderLO+Kfcnte2X71G9VzCvjulhfZaJFFjJSrCj7/DjCqgh0VN6EvSIsCUAXndxPvDxf1w5t4gjoY1qEnAYUfI8SpuokOlyIBIPhC06nSwHUZDIhNzcXoVAIRF7k5OQoLc83/E1eutSKpuYmRKToLZs3l6Zzhqo5QyPR6FVPfcJZg2lFN6Py80q+kbp2WzLwUEe/OZ2Ovr4YU11przqL/5XoRH3fvakwmjFdQtlH4/FC6VdY/dRNVKEYeMqAUR3EiSo9Vj56As2+MKwGMx68fySm5o+HSeDh6FLM7/fVu1zO3v24axcUFJDneZX+SkrgXq8PlZUnEKKKwGpNgM/rmaLT66Z1uzwxVBoC0JKqtTjpPtVd8sQ8YJKM+g3W5Ze/HpZ3f9r0kahk5aq41b/st1c8A3uYOQQrr0uyFwep+ujrG6HHip/YsPvlTmz+7dcovnMGZk4gt6cYKXQFMWuyAV98+iOcpfB6e9HzFBvvoS87J9XfynKZWFnfbLfzbwOlmpEkCauffhpejxenvjqF7KxsdPF6PByCz+PH6dOnKVRUW8eMGX1LN0MJ0MgQLl/dVgNb8YjuAj/qRFJhMmYVzkkv/3NZAV6jJPS4W/gWGLDr/Ua/mkQMzQM2T4dN58Q/DxbizuIKLLjtHax7bhqWPJaLVJMWPsXpzah3SWj3n6GQMKf7/wAmP6/65fq6uubGpsaOFntLuqPdARe5v4fY2emi1uej/OBmjjan3+V2tfi8voZYLFoXlaJnjQZDhZoJgi7GXX4IQPNN+Th9sJuhmKuCWM5w5pvqNiSLlfg/yhcLx2PEqA+QqhR/wX5jHirrdbIJI24A/lG9Gqt/U45NWz7Ey9s/BzQ3QpUQQajdjMS0NixdtQhFxTfTGzVQDc6rFJ/85Zdfem6ePr29dMuWdGKi5PV6Ov2BQFMoFL5INXqtx+upd3d21rXY7Y5AIMBvTp8FCJeXl/nVBKNFRa7Ag+xgsnH2K0p79+474Ix1IJWy5qgXuw40MPb8dwFkOFfngA0nY9zqQe1WnrQtzQRSBgwGEXs2zqUHmXvFvCCFLwP/Lw6PdhQLjVqFVIwSkCRFIgdPVp+sI66d7ury1Xrc7saGhkZ7OBziAEpxGotXYYQg/J4CReZwh3fdriqM2IQkrZN1mg/H9joY+4DMvSyt+eQlTL71uf8a+65VfvVw5nDh5Jpl58NHMK5FCT88diaSGi4DFYnTHvDkgTUyl/8IMABtKh8piZwIuwAAAABJRU5ErkJggg==);margin-right:.5em;content:' '}.icon-ical:before{background-position:-68px 0}.icon-outlook:before{}.icon-yahoo:before{background-position:-36px +4px}.icon-google:before{background-position:-52px 0}";

    return styles;
  };

  // Make sure we have the necessary event data, such as start time and event duration
  var validParams = function(params) {
    return params.data !== undefined && params.data.start !== undefined &&
      (params.data.end !== undefined || params.data.duration !== undefined);
  };

  var generateMarkup = function(calendars, clazz, calendarId) {
    var result = '';
	result = document.createElement('div');

   // result.innerHTML = '<label for="checkbox-for-' +
    //  calendarId + '" class="add-to-calendar-checkbox">+ Add to my Calendar</label>';
    result.innerHTML += '<input name="add-to-calendar-checkbox" class="add-to-calendar-checkbox" id="checkbox-for-' + calendarId + '" type="checkbox">';

    Object.keys(calendars).forEach(function(services) {
      result.innerHTML += calendars[services];
    });

    result.className = 'add-to-calendar';
    if (clazz !== undefined) {
      result.className += (' ' + clazz);
    }

    addCSS();

    result.id = calendarId;
    return result;
  };

  var getClass = function(params) {
    if (params.options && params.options.class) {
      return params.options.class;
    }
  };

  var getOrGenerateCalendarId = function(params) {
    return params.options && params.options.id ?
      params.options.id :
      Math.floor(Math.random() * 1000000); // Generate a 6-digit random ID
  };

  exports.createCalendar = function(params) {
    if (!validParams(params)) {
      console.log('Event details missing.');
      return;
    }

    return generateMarkup(generateCalendars(params.data),
                          getClass(params),
                          getOrGenerateCalendarId(params));
  };
  
  })(this);
    
      
     
  </script><!-- Add Event  -->
	<script type="text/javascript" ><!-- Fusion Tables and google map  -->
			var color_of_icons; //9-blue,10-green,11-grey,12-orange,13-purple,14-red,15-yellow
			var color_of_icons_text;
			var n;
			var d;
			var directionsDisplay;
			var directionsService = new google.maps.DirectionsService();
			var map;
			var markers2 = [];
			// Enable the visual refresh
			google.maps.visualRefresh = true;
			var s;
			var panorama;
			var tableId = "1VnXlhSBM_FglBZSnM7UZUWSyi4ZYg29Sg7Wh7pv4";
			var tableId2 = "1VnXlhSBM_FglBZSnM7UZUWSyi4ZYg29Sg7Wh7pv4";
			var mc = null;
			
			
			
			//var layer = new google.maps.FusionTablesLayer(tableId2); //create a new FusionTablesLayer
			var layer = new google.maps.FusionTablesLayer({
				suppressInfoWindows: true,
				query: {
					where: "'Event Start' > '2016.03.08' AND 'Event Start' < '2016.03.12'", // query
					from: tableId2,                // encrypted table id
					select: '*'        // location column
				},
				map: map
			});
			//var geocoder = new google.maps.Geocoder();
			var FusionTablesData = null;
			//google.load('visualization', '1', {'packages':['table']});
			
				google.load('visualization', '1', {
					'packages': ['table'],
					'callback': function(getData) {
						// do stuff, if you wan't - it doesn't matter, because the page isn't blank!
					}
				} )

			var infoWindow = new google.maps.InfoWindow({ maxWidth: 320,maxHeight: 350 });
			
			var places ;
			var autocomplete;
			var countryRestrict = { 'country': 'us' };	
			var MARKER_PATH = 'https://maps.gstatic.com/intl/en_us/mapfiles/marker_green';
			var hostnameRegexp = new RegExp('^https?://.+?/');
			var countries = {
			  'au': {
				center: new google.maps.LatLng(-25.3, 133.8),
				zoom: 4
			  },
			  'br': {
				center: new google.maps.LatLng(-14.2, -51.9),
				zoom: 3
			  },
			  'ca': {
				center: new google.maps.LatLng(62, -110.0),
				zoom: 3
			  },
			  'fr': {
				center: new google.maps.LatLng(46.2, 2.2),
				zoom: 5
			  },
			  'de': {
				center: new google.maps.LatLng(51.2, 10.4),
				zoom: 5
			  },
			  'mx': {
				center: new google.maps.LatLng(23.6, -102.5),
				zoom: 4
			  },
			  'nz': {
				center: new google.maps.LatLng(-40.9, 174.9),
				zoom: 5
			  },
			  'it': {
				center: new google.maps.LatLng(41.9, 12.6),
				zoom: 5
			  },
			  'za': {
				center: new google.maps.LatLng(-30.6, 22.9),
				zoom: 5
			  },
			  'es': {
				center: new google.maps.LatLng(40.5, -3.7),
				zoom: 5
			  },
			  'pt': {
				center: new google.maps.LatLng(39.4, -8.2),
				zoom: 6
			  },
			  'us': {
				center: new google.maps.LatLng(37.1, -95.7),
				zoom: 3
			  },
			  'uk': {
				center: new google.maps.LatLng(54.8, -4.6),
				zoom: 5
			  }
			};
			
		
			
			// When the user selects a city, get the place details for the city and
			// zoom the map in on the city.
			function onPlaceChanged() {
				  var place = autocomplete.getPlace();
				  if (place.geometry) {
					map.panTo(place.geometry.location);
					map.setZoom(7);
					search();
				  } else {
					document.getElementById('autocomplete').placeholder = 'Enter a city';
				  }

				};

				// Search for hotels in the selected city, within the viewport of the map.
			function search() {
					  var search = {
						bounds: map.getBounds(),
						types: ['lodging']
					  };

					places.nearbySearch(search, function(results, status) {
					if (status == google.maps.places.PlacesServiceStatus.OK) {
					  clearResults();
					  clearMarkers();
					  // Create a marker for each hotel found, and
					  // assign a letter of the alphabetic to each marker icon.
					  for (var i = 0; i < results.length; i++) {
						var markerLetter = String.fromCharCode('A'.charCodeAt(0) + i);
						var markerIcon = MARKER_PATH + markerLetter + '.png';
						// Use marker animation to drop the icons incrementally on the map.
						markers2[i] = new google.maps.Marker({
						  position: results[i].geometry.location,
						  animation: google.maps.Animation.DROP,
						  icon: markerIcon
						});
						// If the user clicks a hotel marker, show the details of that hotel
						// in an info window.
						markers2[i].placeResult = results[i];
						google.maps.event.addListener(markers2[i], 'click', showInfoWindow);
						setTimeout(dropMarker(i), i * 100);
						addResult(results[i], i);
						  }
						}
					  });  
					  
					function clearMarkers() {
					  for (var i = 0; i < markers2.length; i++) {
						if (markers2[i]) {
						  markers2[i].setMap(null);
						}
					  }
					  markers2 = [];
					}
				};		  
			// [START region_setcountry]
			// Set the country restriction based on user input.
			// Also center and zoom the map on the given country.
			function setAutocompleteCountry() {
			  var country = document.getElementById('country').value;
			  if (country == 'all') {
				autocomplete.setComponentRestrictions([]);
				map.setCenter(new google.maps.LatLng(15, 0));
				map.setZoom(7);
			  } else {
				autocomplete.setComponentRestrictions({ 'country': country });
				map.setCenter(countries[country].center);
				map.setZoom(countries[country].zoom);
			  }
			  clearResults();
			  clearMarkers();
			};
			// [END region_setcountry]

			function dropMarker(i) {
			  return function() {
				markers2[i].setMap(map);
			  };
			};

			function addResult(result, i) {
			  var results = document.getElementById('placesSteps');
			  var markerLetter = String.fromCharCode('A'.charCodeAt(0) + i);
			  var markerIcon = MARKER_PATH + markerLetter + '.png';

			  var tr = document.createElement('tr');
			  tr.style.backgroundColor = (i % 2 == 0 ? '#F0F0F0' : '#FFFFFF');
			  tr.onclick = function() {
				google.maps.event.trigger(markers2[i], 'click');
			  };

			  var iconTd = document.createElement('td');
			  var nameTd = document.createElement('td');
			  var icon = document.createElement('img');
			  icon.src = markerIcon;
			  icon.setAttribute('class', 'placeIcon');
			  icon.setAttribute('className', 'placeIcon');
			  var name = document.createTextNode(result.name);
			  iconTd.appendChild(icon);
			  nameTd.appendChild(name);
			  tr.appendChild(iconTd);
			  tr.appendChild(nameTd);
			  results.appendChild(tr);
			};

			function clearResults() {
			  var results = document.getElementById('results');
			  while (results.childNodes[0]) {
				results.removeChild(results.childNodes[0]);
			  }
			};

			// Get the place details for a hotel. Show the information in an info window,
			// anchored on the marker for the hotel that the user selected.
			function showInfoWindow() {
			  var marker2 = this;
			  places.getDetails({placeId: marker2.placeResult.place_id},
				  function(place, status) {
					if (status != google.maps.places.PlacesServiceStatus.OK) {
					  return;
					}
					 if (place.rating) {
						ratingHtml = '';
						for (var i = 0; i < 5; i++) {
						  if (place.rating < (i + 0.5)) {
							ratingHtml += '&#10025;';
						  } else {
							ratingHtml += '&#10029;';
						  }
						}
					}
					if (place.website) {
						var fullUrl = place.website;
						var website = hostnameRegexp.exec(place.website);
						if (website == null) {
						  website = 'http://' + place.website + '/';
						  fullUrl = website;
						}
					}
					var htmlcotent = '<table>\
						<tr id="iw-url-row" class="iw_table_row">\
						  <td id="iw-icon" class="iw_table_icon"><img class="hotelIcon" ' +  'src="' + place.icon + '"/></td>\
						  <td id="iw-url"><b><a href="' + place.url +  '">' + place.name + '</a></b></td>\
						</tr>\
						<tr id="iw-address-row" class="iw_table_row">\
						  <td class="iw_attribute_name">Address:</td>\
						  <td id="iw-address">' + place.vicinity + '</td>\
						</tr>\
						<tr id="iw-phone-row" class="iw_table_row">\
						  <td class="iw_attribute_name">Telephone:</td>\
						  <td id="iw-phone">' + place.formatted_phone_number + '</td>\
						</tr>\
						<tr id="iw-rating-row" class="iw_table_row">\
						  <td class="iw_attribute_name">Rating:</td>\
						  <td id="iw-rating">' + ratingHtml + '</td>\
						</tr>\
						<tr id="iw-website-row" class="iw_table_row">\
						  <td class="iw_attribute_name">Website:</td>\
						  <td id="iw-website">' + website + '</td>\
						</tr>\
					  </table>';
					infoWindow.setContent(htmlcotent);
					infoWindow.open(map, marker2);
				  });
			};

			// Load the place information into the HTML elements used by the info window.
			function buildIWContent(place) {
				 
				  
				  
			
				    
			};
			
			function detectBrowser() {

						var useragent = navigator.userAgent;

						var mapdiv = document.getElementById("map-canvas");

						if 	(useragent.indexOf('iPhone') != -1 || useragent.indexOf('Android') != -1 ) {

								mapdiv.style.width = '100%';

								mapdiv.style.height = '100%';

							} 

						else 

							{

								mapdiv.style.width = '600px';

								mapdiv.style.height = '800px';

							}

						}
			
			/**
			 * The HomeControl adds a control to the map that
			 * returns the user to the control's defined home.
			 */

			// Define a property to hold the Home state
			HomeControl.prototype.home_ = null;

			// Define setters and getters for this property
			HomeControl.prototype.getHome = function() {
			  return this.home_;
			}

			HomeControl.prototype.setHome = function(home) {
			  this.home_ = home;
			}

			/** @constructor */
			function HomeControl(controlDiv, map, home) {

			  // We set up a variable for this since we're adding
			  // event listeners later.
			  var control = this;

			  // Set the home property upon construction
			  control.home_ = home;

			  // Set CSS styles for the DIV containing the control
			  // Setting padding to 5 px will offset the control
			  // from the edge of the map
			  controlDiv.style.padding = '5px';

			  // Set CSS for the control border
			  var goHomeUI = document.createElement('div');
			  goHomeUI.style.backgroundColor = 'white';
			  goHomeUI.style.borderStyle = 'solid';
			  goHomeUI.style.borderWidth = '2px';
			  goHomeUI.style.cursor = 'pointer';
			  goHomeUI.style.textAlign = 'center';
			  goHomeUI.title = 'Click to set the map to Home';
			  controlDiv.appendChild(goHomeUI);

			  // Set CSS for the control interior
			  var goHomeText = document.createElement('div');
			  goHomeText.style.fontFamily = 'Arial,sans-serif';
			  goHomeText.style.fontSize = '12px';
			  goHomeText.style.paddingLeft = '4px';
			  goHomeText.style.paddingRight = '4px';
			  goHomeText.innerHTML = '<b>Home</b>';
			  goHomeUI.appendChild(goHomeText);

			  // Set CSS for the setHome control border
			  var setHomeUI = document.createElement('div');
			  setHomeUI.style.backgroundColor = 'white';
			  setHomeUI.style.borderStyle = 'solid';
			  setHomeUI.style.borderWidth = '2px';
			  setHomeUI.style.cursor = 'pointer';
			  setHomeUI.style.textAlign = 'center';
			  setHomeUI.title = 'Click to set Home to the current center';
			  controlDiv.appendChild(setHomeUI);

			  // Set CSS for the control interior
			  var setHomeText = document.createElement('div');
			  setHomeText.style.fontFamily = 'Arial,sans-serif';
			  setHomeText.style.fontSize = '12px';
			  setHomeText.style.paddingLeft = '4px';
			  setHomeText.style.paddingRight = '4px';
			  setHomeText.innerHTML = '<b>Set Home</b>';
			  setHomeUI.appendChild(setHomeText);

			  // Setup the click event listener for Home:
			  // simply set the map to the control's current home property.
			  google.maps.event.addDomListener(goHomeUI, 'click', function() {
				var currentHome = control.getHome();
				map.setCenter(currentHome);
			  });

			  // Setup the click event listener for Set Home:
			  // Set the control's home to the current Map center.
			  google.maps.event.addDomListener(setHomeUI, 'click', function() {
				var newHome = map.getCenter();
				control.setHome(newHome);
			  });
			}
			
			
			function showAllTypes2(type) {
				querytemp = "SELECT * FROM "+tableId+" WHERE 'Type' = '"+type+"'";
				query2=querytemp;
				//document.getElementById('infoPanelBottom').innerHTML += "Query is " + queryText +"<br>";
				document.getElementById('EventsListType').innerHTML = " "+ type +" ";
				document.getElementById('EventsListType2').innerHTML = " "+ type +" ";
				queryText = encodeURIComponent(query2);
				startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
				startquery.send(getData);
				//layer.setQuery(query2);
				console.log("part 2 query2 is ",query2);
				layer.setQuery(query2);
			}

			var markerClusterer = null;
			
			function initialize() {
				var geocoder = new google.maps.Geocoder();
				directionsDisplay = new google.maps.DirectionsRenderer();
				panorama = new google.maps.StreetViewPanorama(document.getElementById('pano'));
				var centeredUS = new google.maps.LatLng(35.496456,-101.981445);
				var newyork = new google.maps.LatLng(40.7142700,-74.0059700);
				var losangeles = new google.maps.LatLng(34.0522300,-118.2436800);
				var istanbul = new google.maps.LatLng(38.250768035056424, -91.72011112031248);
				var morefeatures2 = [{"featureType":"water","stylers":[{"color":"#19a0d8"}]},{"featureType":"administrative","elementType":"labels.text.stroke","stylers":[{"color":"#ffffff"},{"weight":6}]},{"featureType":"administrative","elementType":"labels.text.fill","stylers":[{"color":"#e85113"}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#efe9e4"},{"lightness":-40}]},{"featureType":"road.arterial","elementType":"geometry.stroke","stylers":[{"color":"#efe9e4"},{"lightness":-20}]},{"featureType":"road","elementType":"labels.text.stroke","stylers":[{"lightness":100}]},{"featureType":"road","elementType":"labels.text.fill","stylers":[{"lightness":-100}]},{"featureType":"road.highway","elementType":"labels.icon"},{"featureType":"landscape","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"landscape","stylers":[{"lightness":20},{"color":"#efe9e4"}]},{"featureType":"landscape.man_made","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"labels.text.stroke","stylers":[{"lightness":100}]},{"featureType":"water","elementType":"labels.text.fill","stylers":[{"lightness":-100}]},{"featureType":"poi","elementType":"labels.text.fill","stylers":[{"hue":"#11ff00"}]},{"featureType":"poi","elementType":"labels.text.stroke","stylers":[{"lightness":100}]},{"featureType":"poi","elementType":"labels.icon","stylers":[{"hue":"#4cff00"},{"saturation":58}]},{"featureType":"poi","elementType":"geometry","stylers":[{"visibility":"on"},{"color":"#f0e4d3"}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#efe9e4"},{"lightness":-25}]},{"featureType":"road.arterial","elementType":"geometry.fill","stylers":[{"color":"#efe9e4"},{"lightness":-10}]},{"featureType":"poi","elementType":"labels","stylers":[{"visibility":"on"}]}];
				var myOptions = {
							//center: new google.maps.LatLng(cnMFUI.opts.mapCenterLt, cnMFUI.opts.mapCenterLg),35.496456,-101.981445
							center: istanbul,
							//zoom: cnMFUI.opts.mapZoom,
							zoom: 4,
							panControl:true,
							zoomControl:true,
							mapTypeControl:true,
							scaleControl:true,
							streetViewControl:true,
							//streetView: new google.maps.StreetViewPanorama(document.getElementById('map_id')),
							overviewMapControl:true,
							rotateControl:true,
							disableDefaultUI: true,
							//mapTypeId: google.maps.MapTypeId.TERRAIN,
							//styles: morefeatures2
							 mapTypeControlOptions: {
							 mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'featureOpts'],					 
							style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
							position: google.maps.ControlPosition.BOTTOM_CENTER
							},
						};
						
				var styledMapOptions2 = {
						  name: 'Shmik Style'
						};
				var featureOpts = 	[{"featureType":"administrative","stylers":[{"visibility":"on"}]}
														,{"featureType":"poi","stylers":[{"visibility":"simplified"}]}
														,{"featureType":"road","elementType":"labels","stylers":[{"visibility":"simplified"}]}
														,{"featureType":"water","stylers":[{"visibility":"simplified"}]}
														,{"featureType":"transit","stylers":[{"visibility":"simplified"}]}
														,{"featureType":"landscape","stylers":[{"visibility":"simplified"}]}
														,{"featureType":"road.highway","stylers":[{"visibility":"on"}]}
														,{"featureType":"road.local","stylers":[{"visibility":"on"}]}
														,{"featureType":"road.highway","elementType":"geometry","stylers":[{"visibility":"on"}]}
														,{"featureType":"water","stylers":[{"color":"#84afa3"},{"lightness":52}]}
														,{"stylers":[{"saturation":-17},{"gamma":0.36}]}
														,{"featureType":"transit.line","elementType":"geometry","stylers":[{"color":"#3f518c"}]}
														];	
				var MY_MAPTYPE_ID = 'custom_style';			
				map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);
				//var customMapType = new google.maps.StyledMapType(featureOpts, styledMapOptions);
				 
				 var styledMapOptions = {
					name: 'US Road Trip'
				  };
				 
				  var usRoadMapType = new google.maps.StyledMapType(
					  featureOpts, styledMapOptions);

				  map.mapTypes.set('featureOpts', usRoadMapType);
				  map.setMapTypeId('featureOpts');
				  
				  var usRoadMapType2 = new google.maps.StyledMapType(
					  morefeatures2, styledMapOptions2);

				  map.mapTypes.set('morefeatures2', usRoadMapType2);
				  map.setMapTypeId('morefeatures2');
				
				//map.mapTypes.set(MY_MAPTYPE_ID, customMapType);
				directionsDisplay.setMap(map);
				google.maps.event.addListener(map, 'click', function() {
					infoWindow.close();
				});
				// Create the DIV to hold the control and
				  // call the HomeControl() constructor passing
				  // in this DIV.
				  var homeControlDiv = document.createElement('div');
				  var homeControl = new HomeControl(homeControlDiv, map, istanbul);

				  homeControlDiv.index = 1;
				  map.controls[google.maps.ControlPosition.TOP_CENTER].push(homeControlDiv);
				
				//document.getElementById('side_bar').innerHTML = "querying for data";
				var queryStr = "SELECT * FROM "+tableId+" ";
				var querystart = "SELECT * FROM "+tableId+" WHERE 'Event Start' > '2016.03.08' AND 'Event Start' < '2016.03.12'";		
				var queryTextStart = encodeURIComponent(querystart);
				var startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryTextStart);
				var dend2 = new Date("2016.03.12");
				//dend = parseDate(s.getValue()+s.getExtent());
				var dstart2 = new Date("2016.03.08"); 
				var StartMonth2 = dstart2.getMonth() + 1;
				var EndMonth2 = dend2.getMonth() + 1;
				var fromshortdate2 = 
				//dstart = parseDate(s.getValue());
				console.log("dstart/dend is ",dstart2,dend2);
				var test_return_dstart2 = ""  +  dstart2.getDate() + "/" + StartMonth2+ ""; 
				var test_return_dend2 = ""  + dend2.getDate()+ "/" + EndMonth2 + ""; 
				document.getElementById('EventsListText').innerHTML = " Showing" + "&nbsp";;
				document.getElementById('EventsListType').innerHTML = "Start Dates";			
				document.getElementById('EventsListType2').innerHTML = "Start Dates";			
				document.getElementById('EventsListQuery').innerHTML = " " + " dates " + " " + test_return_dstart2 + " to " + test_return_dend2 + "<b>(<a href='./about.html#where-did-you-get-your-data-from'>?</a>)</b><br> ";
				
				
				startquery.send(getData);
				
				layer.setQuery(startquery);
				layer.setMap(map);
				//querystart.send(getData);
				
				 // We get the map's default panorama and set up some defaults.
				  // Note that we don't yet set it visible.
				  panorama = map.getStreetView();
				  panorama.setPosition(istanbul);
				  panorama.setPov(/** @type {google.maps.StreetViewPov} */({
					heading: 265,
					pitch: 0
				  }));
					var controlDiv = document.createElement('div');
					$(controlDiv).addClass('gmap-control-container')
					controlDiv.style.padding = '5px';
					controlDiv.style.top = '20px';
					controlDiv.style.borderStyle = 'solid';
					controlDiv.style.borderWidth = '1px';
					controlDiv.style.cursor = 'pointer';
					controlDiv.style.textAlign = 'center';
					var table=document.createElement('TABLE');
					var tbdy=document.createElement('TBODY');
					var tr=document.createElement('TR');
					
					var btn1=document.createElement('input');
					btn1.setAttribute("type", "button");
					btn1.title = 'Click to set the map to New York';
					btn1.id="c_placemark_b";
					btn1.setAttribute("value", "New York");

					var td1=document.createElement('TD');
					td1.appendChild(btn1);
					
					var btn2=document.createElement('input');
					btn2.setAttribute("type", "button");
					btn1.title = 'Click to set the map to Los Angeles';
					btn2.id="c_line_b";
					btn2.setAttribute("value", "Los Angeles");
					var td2=document.createElement('TD');
					td2.appendChild(btn2);

					tr.appendChild(td1);
					tr.appendChild(td2);
					tbdy.appendChild(tr);
					table.appendChild(tbdy);
					controlDiv.appendChild(table);

					google.maps.event.addDomListener(btn1, 'click', function() {
						//DoSomething
						map.setCenter(newyork)
					});
					
					google.maps.event.addDomListener(btn2, 'click', function() {
						map.setCenter(losangeles)
					});
					
					controlDiv.index = 1;
					map.controls[google.maps.ControlPosition.TOP_CENTER].push(controlDiv);  
				  
				  
				
				var controlDiv2 = document.createElement('DIV');
				$(controlDiv2).addClass('gmap-control-container')
							 .addClass('gmnoprint');
						  
				var controlUI = document.createElement('DIV');
				$(controlUI).addClass('gmap-control');
				$(controlUI).text('Traffic');
				$(controlDiv2).append(controlUI);
						  
				var legend = '<a class="b-close">x<a/><ul>'
						   + '<li><span style="background-color: #30ac3e">&nbsp;&nbsp;</span><span style="color: #30ac3e"> &gt; 80 km per hour</span></li>'
						   + '<li><span style="background-color: #ffcf00">&nbsp;&nbsp;</span><span style="color: #ffcf00"> 40 - 80 km per hour</span></li>'
						   + '<li><span style="background-color: #ff0000">&nbsp;&nbsp;</span><span style="color: #ff0000"> &lt; 40 km per hour</span></li>'
						   + '<li><span style="background-color: #c0c0c0">&nbsp;&nbsp;</span><span style="color: #c0c0c0"> No data available</span></li>'
						   + '</ul>';
					  
				var controlLegend = document.createElement('DIV');
				$(controlLegend).addClass('gmap-control-legend');
				$(controlLegend).html(legend);
				$(controlLegend).hide();
				$(controlDiv2).append(controlLegend);
					  
				// Set hover toggle event
				$(controlUI)
					.mouseenter(function() {
						$(controlLegend).show();
					})
					.mouseleave(function() {
						$(controlLegend).hide();
					});
					  
				var trafficLayer = new google.maps.TrafficLayer();
					  
				google.maps.event.addDomListener(controlUI, 'click', function() {
					if (typeof trafficLayer.getMap() == 'undefined' || trafficLayer.getMap() === null) {
						$(controlUI).addClass('gmap-control-active');
						trafficLayer.setMap(map);
					} else {
						trafficLayer.setMap(null);
						$(controlUI).removeClass('gmap-control-active');
					}
				});
					  
				map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(controlDiv2);	
				//trafficLayer.setMap(map);		
				
				
				
				getLocationNames();
				getTypeNames();
				getimages();
					// Create the autocomplete object and associate it with the UI input control.
				  // Restrict the search to the default country, and to place type "cities".
				  autocomplete = new google.maps.places.Autocomplete(
					  /** @type {HTMLInputElement} */(document.getElementById('autocomplete')),
					  {
						types: ['(cities)'],
						componentRestrictions: countryRestrict
					  });
				  places = new google.maps.places.PlacesService(map);

					google.maps.event.addListener(autocomplete, 'place_changed', onPlaceChanged);

				  // Add a DOM event listener to react when the user selects a country.
				  google.maps.event.addDomListener(document.getElementById('country'), 'change',
				  setAutocompleteCountry);
				  
					var transitLayer = new google.maps.TransitLayer();
						transitLayer.setMap(null);
						
					var weatherLayer = new google.maps.weather.WeatherLayer({
						temperatureUnits: google.maps.weather.TemperatureUnit.celsius
					  });
					  weatherLayer.setMap(null);

					var cloudLayer = new google.maps.weather.CloudLayer();
						cloudLayer.setMap(null);
							
					var myTrip=[Florida,DisneyWorld,Florida_Caverns_State_Park,New_Orleans,Barataria_Preserve,shallow_creek_rv_resort,Childress,KOA_Kampgrounds,Gouldings_Lodge,Grand_Canyon_National_Park,MGM_Grand,Circus_Circus_Drive,Kettleman_City,san_fran,Muir_Woods_National_Monument,Whinchester_Mystery_House,Hawethorne,LA,LA2,LA3,LA4];

					var flightPath=new google.maps.Polyline({
							  path:myTrip,
							  strokeColor:"#6CD900",
							  strokeOpacity:2,
							  strokeWeight:8,
							  fillColor:"#BFDFFF",
							  fillOpacity:0.2
							  });
						flightPath.setMap(null);
						
					var flightPathButton = document.getElementById('flightPathButton');
						google.maps.event.addDomListener(flightPathButton, 'click', function() {
						flightPath.setMap(flightPath.getMap() ? null : map);
					});
						
					panoramioLayer = new google.maps.panoramio.PanoramioLayer();
						panoramioLayer.setMap(null);

					var PanoramioButton = document.getElementById('PanoramioButton');
						google.maps.event.addDomListener(PanoramioButton, 'click', function() {
						panoramioLayer.setMap(panoramioLayer.getMap() ? null : map);
					});
						
						var WeatherButton = document.getElementById('WeatherButton');
							google.maps.event.addDomListener(WeatherButton, 'click', function() {
							weatherLayer.setMap(weatherLayer.getMap() ? null : map);
						});
						
						var TransitButton = document.getElementById('TransitButton');
							google.maps.event.addDomListener(TransitButton, 'click', function() {
							transitLayer.setMap(transitLayer.getMap() ? null : map);
						});	
						
						var CloudButton = document.getElementById('CloudButton');
							google.maps.event.addDomListener(CloudButton, 'click', function() {
							cloudLayer.setMap(cloudLayer.getMap() ? null : map);
						});
						
						
						map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(
						document.getElementById('legend'));
						
						
			} //end initialize
			
			function getTaggedPhotos() {
					  var tagFilter = document.getElementById('tag').value;
					  panoramioLayer.setTag(tagFilter);
					}
					
			function toggleStreetView() {
					  var toggle = panorama.getVisible();
					  if (toggle == false) {
						panorama.setVisible(true);
					  } else {
						panorama.setVisible(false);
					  }
					}
			
			function computeTotalDistance(result) {
					  var total = 0;
					  var myroute = result.routes[0];
					  for (var i = 0; i < myroute.legs.length; i++) {
						total += myroute.legs[i].distance.value;
					  }
					  total = total / 1000.0;
					  document.getElementById('total').innerHTML = total + ' km';
					}

			var markeres = Array();
			var infos = Array();
			
			// clear overlays function
			function clearOverlays() {
				if (markeres) {
					for (i in markeres) {
						markeres[i].setMap(null);
					}
					markeres = [];
					infos = [];
					$('#results').empty();
					
				}
			}

			// clear infos function
			function clearInfos() {
				if (infos) {
					for (i in infos) {
						if (infos[i].getMap()) {
							infos[i].close();
						}
					}
				}
			}
			
			// clear directions
			function clearDirections() {
				$('#directionSteps').html('');
			}
				
				geocoder = new google.maps.Geocoder();
				
				// find address function
				function findAddress() {
					var address = document.getElementById("gmap_where").value;

					// script uses our 'geocoder' in order to find location by address name
					geocoder.geocode( { 'address': address}, function(results, status) {
						if (status == google.maps.GeocoderStatus.OK) { // and, if everything is ok

							// we will center map
							var addrLocation = results[0].geometry.location;
							map.setCenter(addrLocation);

							// store current coordinates into hidden variables
							// document.getElementById('lat').value = results[0].geometry.location.Xa;
							// document.getElementById('lng').value = results[0].geometry.location.Ya;
							document.getElementById('lat').value = results[0].geometry.location.lat();
							document.getElementById('lng').value = results[0].geometry.location.lng();

							// and then - add new custom marker
							var addrMarker = new google.maps.Marker({
								position: addrLocation,
								map: map,
								title: results[0].formatted_address,
								icon: 'marker.png'
							});
						} else {
							alert('Geocode was not successful for the following reason: ' + status);
						}
					});
				}
				
				// find custom places function
				function findPlaces() {

					// prepare variables (filter)
					var type = document.getElementById('gmap_type').value;
					var radius = document.getElementById('gmap_radius').value;
					var keyword = document.getElementById('gmap_keyword').value;

					var lat = document.getElementById('lat').value;
					var lng = document.getElementById('lng').value;
					var cur_location = new google.maps.LatLng(lat, lng);

					// prepare request to Places
					var request = {
						location: cur_location,
						radius: radius,
						types: [type]
					};
					if (keyword) {
						request.keyword = [keyword];
					}

					// send request
					service = new google.maps.places.PlacesService(map);
					
					
					
					service.search(request, createmarkeres);
				}

				// create markers (from 'findPlaces' function)
				function createmarkeres(results, status) {
					if (status == google.maps.places.PlacesServiceStatus.OK) {
						// if we have found something - clear map (overlays)
						clearOverlays();
						// and create new markers by search result
						for (var i = 0; i < results.length; i++) {
							createMarker1(results[i]);
							addResult(results[i], i);
						}
					} else if (status == google.maps.places.PlacesServiceStatus.ZERO_RESULTS) {
						alert('Sorry, nothing is found');
					}
				}

				// creare single marker function
				function createMarker1(obj) {
					// prepare new Marker object
					console.log("obj is",obj);
				  var photos = obj.photos;
				  if (!photos) {
					photos = obj.icon;
				  } else
				  {
					photos = obj.photos[0].getUrl({'maxWidth': 30, 'maxHeight': 30});
					var bigphotos = obj.photos[0].getUrl({'maxWidth': 145, 'maxHeight': 200});
				  }

				 
				  
					var mark = new google.maps.Marker({
						position: obj.geometry.location,
						map: map,
						icon: photos,
						title: obj.name
					});
					markeres.push(mark);
					map.setZoom(15);
					// prepare info windownew google.maps.InfoWindow({ maxWidth: 320 });
					var infowindow = new google.maps.InfoWindow({ maxWidth: 380,maxHeight: 300,
							content: '<div id="infodiv" style="maxwidth: 380px;maxheight: 300px; background:#F1F1F1;"><img style="maxWidth:30;maxHeight:30;" src="' + obj.icon + '" /></br>\
										<font style="color:#0000B3;">Name: ' + obj.name + 
										'<br />Address: ' + obj.vicinity + 
										'<br />Phone: ' + obj.formatted_phone_number + 
										'<br />Price: ' + obj.price_level + 
										'<br />Rating: ' + obj.rating + 
										'<br />Types: ' + obj.types + 
										'<br />Website: ' + obj.url +
										'<br />Photo:' + "<img src='"+ bigphotos + "' />" + '</font></div>'	+	
									 '<div id="infodiv" style="maxwidth: 380px;maxheight: 300px; background:#F1F1F1;"><strong><a href="'+obj.url+'">"' + obj.name + '"</a></strong></br>\
									<span style="maxwidth: 200px;">"' +obj.name + '"</span></br>'+
										"<div id='info-container'>"+
										"<br />Get Directions<br />"+
										"<form>"+
										"<input type='radio' name='direction' value='from' checked='true' /> From Here "+
										"<input type='radio' name='direction' value='to' /> To Here <br />"+
										"<input type='input' name='destination' value=''>"+			
										"<input type='button' value='Go' onclick='getDirections1("+mark.getPosition().lat()+","+mark.getPosition().lng()+",destination.value, direction.value);'>"+
										"</form>"+
										"<br />Add Event<br />"+
										"<div id='addeventlink'></div>"+
										"<form>"+
										"<input type='button' class='new-cal' value='Go' onclick='setEventDetails();'>"+
										"</form>"+
										"</div>"			
						
					});
						
					
			
					
					// add event handler to current marker
					google.maps.event.addListener(mark, 'click', function() {
						clearInfos();
						infowindow.open(map,mark);
						map.setZoom(15);
						infoWindow.setPosition(obj.geometry.location); 
						map.setCenter(obj.geometry.location);
					});
					infos.push(infowindow);
					
					// Listen for user click on map to close any open info bubbles
					google.maps.event.addListener(map, "click", function () { 
					  clearInfos();
					});
					
				}
							
			function calcRoute() {
			  var start = document.getElementById("dirSourceLeft").value;
			  var end = document.getElementById("dirDestinationLeft").value;
			  var request = {
				origin:start,
				destination:end,
				travelMode: google.maps.TravelMode.DRIVING
			  };
			  directionsService.route(request, function(result, status) {
				if (status == google.maps.DirectionsStatus.OK) {
				  directionsDisplay.setDirections(result);
				  directionsDisplay.setPanel(jQuery('#directionSteps')[0]);		
				}
			  });
			}
			
			function calcRoute1(location,start1,end1) {
			console.log("calroute1",location,start1,end1)
				if (start1 != '') {
					var start = start1;
				} {
					start = location;
				}
				if (end1 != '') {
					var end = end1;
				} {
					end = location;
				}
			  var request = {
				origin:start,
				destination:end,
				travelMode: google.maps.TravelMode.DRIVING
			  };
			  directionsService.route(request, function(result, status) {
				if (status == google.maps.DirectionsStatus.OK) {
				  directionsDisplay.setDirections(result);
				  directionsDisplay.setPanel(jQuery('#directionSteps')[0]);		
				}
			  });
			}
			
			
			function getDirections1(mlat, mlng, address, direction){
				
				if(address != null || address.value.trim() != ""){
					geocoder.geocode( { 'address': address}, function(results, status) {
					  if (status != google.maps.GeocoderStatus.OK) {
						alert("Geocode was not successful for the following reason: " + status);
					  }
						var start, end;		   	
					if(direction == "from"){ 
							start = new google.maps.LatLng(mlat, mlng);
							end = results[0].geometry.location;
						} else {
							start = results[0].geometry.location;
							end = new google.maps.LatLng(mlat, mlng);
						}
						
						
						var request = {
					  origin: start,
					  destination: end,
					  travelMode: google.maps.DirectionsTravelMode.DRIVING
					};
			
					directionsService.route(request, function(response, status) {
					  if (status == google.maps.DirectionsStatus.OK) {
						directionsDisplay.setDirections(response);
						
						directionsDisplay.setPanel(jQuery('#directionSteps')[0]);		
					  }
					  else alert(status);
					});
						
					});
				}
			}
			
				
			function setEventDetails() {
				//var newlocationvalue = document.getElementsByTagName("a")[34];
				//start = document.getElementsByClassName("_location")[0].innerHTML;
				var addeventlinkdiv = document.getElementById("addeventlink");
				//start = newlocationvalue.getElementById("loc").InnerHTML;
				//console.log("1st addeventlinkdiv ",addeventlinkdiv);
				//console.log("1st start ",start);
				//var span = document.getElementById('loc')[0];
				//var span2 = document.getElementById('tested');
				//console.log("1st span "+span2+"");
				
				//span.appendChild( document.createTextNode("some new content") );
				//while( span.firstChild ) {
				//	span.removeChild( span.firstChild );
				//}
				//span.appendChild( document.createTextNode("some new content") );
				//var center = map.getCenter();
				//var latlng = center.lat() + ', ' + center.lng();
				var latlng = new google.maps.LatLng(map.getCenter().lat(), map.getCenter().lng()); 
				console.log("latlng "+latlng+"");
				//var origin = document.getElementById("orig").value;
				//var destination = document.getElementById("dest").value;
				geocoder = geocoder = new google.maps.Geocoder();
				geocoder.geocode({ 'latLng': latlng }, function (results, status) {
					if (status == google.maps.GeocoderStatus.OK) {
						if (results[0]) {
							var newlocation = results[0].formatted_address ;
							var myCalendar = createCalendar({
										options: {
										  class: 'my-class',
										  id: 'my-id'                               // You need to pass an ID. If you don't, one will be generated for you.
										},
										data: {
										  title: 'Holiday Event',     // Event title
										  start: new Date('March 15, 2016 19:00'),   // Event start date
										  duration: 120,                            // Event duration (IN MINUTES)
										  end: new Date('March 15, 2016 23:00'),     // You can also choose to set an end time.
																					// If an end time is set, this will take precedence over duration
										  address: newlocation,
										  description: 'USA Event - add guest!.'
										}
									  });
							
							document.querySelector('.new-cal').appendChild(myCalendar);
				 
							//document.getElementsByClassName("_location")[0].innerHTML ="";
							//start = document.getElementById("addeventlink").innerHTML = newaddeventlinkdiv;
							//console.log("newlocation "+start+"");
							//start = document.getElementById("addeventlink").innerHTML;
							//console.log("final start "+start+"");
							//'alert("Location: " + results[1].formatted_address + "\r\nLatitude: " + e.latLng.lat() + "\r\nLongitude: " + e.latLng.lng());
						} 
					}
				});	
			};
						
			function toggleStreetView() {
			  var toggle = panorama.getVisible();
			  if (toggle == false) {
				panorama.setVisible(true);
			  } else {
				panorama.setVisible(false);
			  }
			}
			
			function removeMarkers(){
				var r;
				for(r=0;r<markers.length;r++){
				markers[r].setMap(null);
				}
				markers = [];
				//console.log("1st (in remove) we should be clearing the markers now, checking markers count",markers.length);
				google.maps.event.clearListeners(map, 'click');
				
			}
			
			//google.maps.event.addListener(layer, 'click', displayData);
			//initializeSlider();			
			//var layer = new google.maps.FusionTablesLayer({query:{from:tableId}, map:map, suppressInfoWindows: true});
			
			
			
			
			function getData(response) {
				getHeight();
				
				
				markers = [];
			  console.log("Getting new data ",markers.length);
			  if (!response) {
				alert('no response');
				return;
			  }
			  if (response.isError()) {
				alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
				return;
			  } 
			  var dt ;//= new google.visualization.DataTable(response.table);
			  //FusionTablesData = [];
			  FusionTablesData = response.getDataTable();  
			  //var dt = [];
			  dt = FusionTablesData;
			  console.log("3rd 			  dt",			  dt);
			  //markers = [];	
			  
			  var side_html =  '<div id="rtSide"> \
									<table style="border-collapse: collapse; overflow:auto; " border="1" \
							   cellpadding="5"> \
							   <thead> \
								 <tr style="background-color:#4CFFD2;color:#000000;"> \
								   <th style="width:20px;background-color:#4CFFD2;color:#000000;">Date</th> \
								   <th style="width:25px;background-color:#4CFFD2;color:#000000;">Title</th> \
								   <th style="width:130px;background-color:#4CFFD2;color:#000000;">Desc</th> \
								   <th style="width:30px;background-color:#4CFFD2;color:#000000;">Type</th> \
								   <th style="width:60px;background-color:#4CFFD2;color:#000000;">Location</th> \
								 </tr> \
							   </thead> \
							   <tbody>';
			 //console.log("numRows is", dt.getNumberOfRows());
			// document.getElementById('EventsListQuery3').innerHTML = "Viewing "+dt.getNumberOfRows()+" events ";
			 document.getElementById('EventsListCount').innerHTML = " "+dt.getNumberOfRows()+" ";
			 document.getElementById('EventsListCount2').innerHTML = " "+dt.getNumberOfRows()+" ";
				var today = new Date();
				var d = today.getDay();
				//console.log("1st d ",d);
				if (d == 0) {	
								//Sund2ay is green
								color_of_icons_text = 'green';
								color_of_icons = 10;
						} else if (d == 1) {
							//Monday is green
							color_of_icons_text = 'purple';
							color_of_icons = 13;
							console.log("1st day ",d,n);

						} else if (d == 2) {
								//Tuesd2ay is green
								color_of_icons_text = 'grey';
								color_of_icons = 11;
						} else if (d == 3) {
								//Wed2nesd2ay is green
								color_of_icons_text = 'blue';
								color_of_icons = 9;
						} else if (d == 4) {
								//Thursd2ay is green
								color_of_icons_text = 'red';
								color_of_icons = 14;
						} else if (d == 5) {
								//Frid2ay is green
								color_of_icons_text = 'orange';
								color_of_icons = 12;
						} else if (d == 6) {
							//Saturday is green
							color_of_icons_text = 'yellow';
							color_of_icons = 15;
						} else {
							//Saturday is green
							color_of_icons_text = 'red';
							color_of_icons = 14;
						}
				//console.log("1st color ",d);
    		
			  //document.getElementById('infoPanelBottom').innerHTML += "<br>rows="+dt.getNumberOfRows()+"<br>";
			  for (var i = 0; i < dt.getNumberOfRows(); i++) {
				var  start_date = dt.getValue(i,4);
				var  title = dt.getValue(i,1);
				var desc = dt.getValue(i,2);
				var activity = dt.getValue(i,17);
				var url = dt.getValue(i,17);
				var lat = dt.getValue(i,6);
				var lng = dt.getValue(i,7);
				var type = dt.getValue(i,8);
				var location = dt.getValue(i,3);
				var image = dt.getValue(i,color_of_icons);//grey
				var markerid = i;
				//console.log("markerid is", markerid);
				if (!isNaN(lat) && !isNaN(lng)) {
					 var event_link = '';	
				//document.getElementById('EventsListQuery3').innerHTML += "<br>"+event_link;
				  var latlng = new google.maps.LatLng(lat,lng);
				  var html = "<div id='infodiv' style='maxwidth: 350px;maxheight: 350px; background:#F1F1F1;'><strong><a href='"+url+"'>" + title + "</a></strong></br>";
				   if (markerid) html += "<b>" +markerid + "</b></br>";
				  if (start_date) html += start_date + "</br>";
				  if (Image) html += Image + "</br>";
				  if (desc) html += "</br></br></br><span style='maxwidth: 200px;'>" +desc + "</span></br>";
				  if (location) html += location + '.......</br>Add Event</br></br></div>';
				 
				  
				
				  side_html += '<tr> \
								<td style="background-color:#CEFFE7;"><a href="javascript:myclick(' + i + ')" style="color:#000000;">' + start_date + '</a></td> \
								<td style="background-color:#CEFFE7;width:25px;"><a href="javascript:myclick(' + i + ')" style="color:#000000;">' + title + '</a></td> \
								<td style="background-color:#CEFFE7;"><a href="javascript:myclick(' + i + ')" style="color:#000000;">' + desc + '</a></td> \
								<td style="background-color:#CEFFE7;"><a href="javascript:myclick(' + i + ')" style="color:#000000;">' + type + '</a></td> \
								<td style="background-color:#CEFFE7;"><a href="javascript:myclick(' + i + ')" style="color:#000000;">' + location + '</a></td> \
							  </tr>';
			  
				markers.push(createMarker(latlng, desc,image,start_date,location,title,html,markerid,activity,url));
				  
				} else {
				  alert("bad coordinates: marker "+i+", hotel="+hotels);
				}
			  }
			 

			  side_html += '</tbody> \
						</table> \
						 </div>';
			  document.getElementById("directionStepsRight").innerHTML = side_html;
			}
			
			function ZoomMap(point) {
				map.setCenter(point);
			}
			
			function infoBubble_close() {
				//if (infoBubble.isOpen()) {
					infoBubble.close();
				//}
			}

			function createMarker(point,info,image,start_date,location,title,html,markerid,activity,url) {
			 // console.log("html is num"+markerid+"", html,markerid);
			  var myMarkerOpts = {
				position: point,
				icon: image,
				animation: google.maps.Animation.DROP,
				zIndex: markerid, //markers[markers.length],
				anchorPoint: new google.maps.Point(3,-4),
				html: html,//' Title? '+title+'<br/>\n Desc? '+info+'<br/>\n Image? '+info+'<br/>\n When? '+start_date+'<br/>\n Where? '+location,
				map: map,
				title: title
			  };
			  
			  			   var  infoBubble = new InfoBubble({
						  maxWidth: 320,
						  maxHeight: 450
						});

			  
			 var marker = new google.maps.Marker(myMarkerOpts);
			   var Acthtml = "<div id='infodiv' style='maxwidth: 350px;maxheight: 350px; background:#F1F1F1;'><strong><a href='"+url+"'>" + title + "</a></strong></br>";
				  if (location) Acthtml += "</br></br></br><span style='maxwidth: 200px;'>" +activity + "</span></br>";
				  if (location) Acthtml += location + '.......</br>Add Event</br></br></div>';
				  var Photohtml = "<div id='infodiv' style='maxwidth: 350px;maxheight: 350px; background:#F1F1F1;'><strong><a href='"+url+"'>" + title + "</a></strong></br>";
				  if (Image) html += Image + "</br>";
				  if (location) Acthtml += location + '.......</br>Add Event</br></br></div>';
				  //' Title? '+title+'<br/>\n Desc? '+info+'<br/>\n Image? '+info+'<br/>\n When? '+start_date+'<br/>\n Where? '+location
					Acthtml += "<div id='info-container'>"+
					"<br />Get Directions<br />"+
					"<form>"+
					"<input type='radio' name='direction' value='from' checked='true' /> From Here "+
					"<input type='radio' name='direction' value='to' /> To Here <br />"+
					"<input type='input' name='destination' value=''>"+			
					"<input type='button' value='Go' onclick='getDirections1("+marker.getPosition().lat()+","+marker.getPosition().lng()+",destination.value, direction.value);'>"+
					"</form>"+
					"<br />Edit Event<br />"+
					"<div id='addeventlink'></div>"
					"<form>"+
					"<input type='button' class='new-cal' value='Go' onclick='#'>"+
					"</form>"+
					"</div>";		
				 console.log("3rd ",marker);
				//console.log("3rd ",location.getPosition().lat(),location.getPosition().lng());
			  //map.panTo(marker.getLatLng());
				
			 
			  //markers.push(marker);
			  //mc.addMarkers(markers);  
			  google.maps.event.trigger(marker, 'click', function() {
				  latLng: new google.maps.LatLng(0, 0)
				 
				});
				
				
			
			

			  google.maps.event.addListener(marker, 'dblclick', function() {
				infoWindow.close();
				infoWindow.setContent(this.html);
				infoWindow.setPosition(point); 
				infoWindow.open(map,marker); 
				map.setZoom(15);
				map.setCenter(point);
			  });
			  

				var div = document.createElement('DIV');
				var content = '<div style="text-align: center; font-size:14px;">\
											<center><b>Diamantino, Brazil</b></center>\
											<img width="240" height="180" src="http://mw2.google.com/mw-panoramio/photos/small/7253919.jpg"/>\
											<div style="margin: auto; text-align: right; width: 240px;" class="linkbutton">\
												<a href="http://www.panoramio.com/user/279908">Edson Walter Cavalari</a>\
											</div>\
											<div class="linkbutton">\
												<a href="http://www.panoramio.com/photo/7253919" target="_blank">See more photos at Panoramio.com</a>\
											</div><br/>\
											<div class="linkbutton">\
												<a href="http://www.google.com/search?q=site:wikipedia.org+Diamantino,Brazil&amp;btnI=I\'m+Feeling+Lucky" target="_blank">Read more about this location</a>\
											</div>\
											<div class="linkbutton">\
												<a href="onclick="ZoomMap(point)" id="zoomLink">Zoom in to this location</a>\
											</div>\
										</div>';
        
				div.innerHTML = html;
				
				infoBubble.addTab('Event', div);
				infoBubble.addTab('Activities', Acthtml);
				infoBubble.addTab('Reviews', content);
				infoBubble.addTab('Photo/Video', Photohtml);
				google.maps.event.addListener(marker, 'click', function() {
					infoBubble.close();
				  if (!infoBubble.isOpen()) {
					infoBubble.open(map, marker);
					map.setZoom(15);
					map.setCenter(point);
				  }
				});
				
				// Listen for user click on map to close any open info bubbles
				google.maps.event.addListener(map, "click", function () { 
				  infoBubble.close();
				});
				
				function infoBubble_close2() {
					//if (infoBubble.isOpen()) {
						infoBubble.close();
					//}
				}
				
			  
			  //console.log("44th we should be seeing the markers now, checking markers count: marker "+markerid+"",markerid);
			  return marker;
			}
			
			
			// When the user selects a city, get the place details for the city and
			// zoom the map in on the city.
			function onPlaceChanged() {
			  var place = autocomplete.getPlace();
			  if (place.geometry) {
				map.panTo(place.geometry.location);
				map.setZoom(15);
				search();
			  } else {
				document.getElementById('autocomplete').placeholder = 'Enter a city';
			  }

			}

			function myclick(num) {
				//console.log("5th we should be seeing the markers now, checking markers count: marker "+num+"",num);
				google.maps.event.trigger(markers[num], "click");
			}
			
			function event() {
				//console.log("who know what we wil see? if anything --- count: marker "+num+"",num);
				
			}
			
			google.maps.event.addDomListener(window, 'load', initialize);
			
			
			function deselect(e) {
			  $('.pop').slideFadeToggle(function() {
				e.removeClass('selected');
			  });    
			}

			$(function() {
			  $('#contact').on('click', function() {
				if($(this).hasClass('selected')) {
				  deselect($(this));               
				} else {
				  $(this).addClass('selected');
				  $('.pop').slideFadeToggle();
				}
				return false;
			  });

			  $('.close').on('click', function() {
				deselect($('#contact'));
				return false;
			  });
			});

			$.fn.slideFadeToggle = function(easing, callback) {
			  return this.animate({ opacity: 'toggle', height: 'toggle' }, 'fast', easing, callback);
			};
			

		
			addthisevent.settings({
			license   : "aao8iuet5zp9iqw5sm9z",
			mouse     : false,
			css       : true,
			outlook   : {show:false, text:"Outlook Calendar"},
			google    : {show:true, text:"Google Calendar"},
			yahoo     : {show:false, text:"Yahoo Calendar"},
			hotmail   : {show:false, text:"Hotmail Calendar"},
			ical      : {show:false, text:"iCal Calendar"},
			facebook  : {show:false, text:"Facebook Event"},
			dropdown  : {order:"google"},
			callback  :  ""
		});

		</script>

  <link rel="stylesheet" href="jqwidgets/styles/jqx.base.css" type="text/css" />
    <script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxcore.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxwindow.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxbuttons.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxscrollbar.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxpanel.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxtabs.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxcheckbox.js"></script>
    <script type="text/javascript" src="js/demos.js"></script>
    <script type="text/javascript">
        var basicDemo = (function () {
            //Adding event listeners
            function _addEventListeners() {
                $('#resizeCheckBox').on('change', function (event) {
                    if (event.args.checked) {
                        $('#window').jqxWindow('resizable', true);
                    } else {
                        $('#window').jqxWindow('resizable', false);
                    }
                });
                $('#dragCheckBox').on('change', function (event) {
                    if (event.args.checked) {
                        $('#window').jqxWindow('draggable', true);
                    } else {
                        $('#window').jqxWindow('draggable', false);
                    }
                });
                $('#showWindowButton').click(function () {
                    $('#window').jqxWindow('open');
                });
                $('#hideWindowButton').click(function () {
                    $('#window').jqxWindow('close');
                });
            };

            //Creating all page elements which are jqxWidgets
            function _createElements() {
                $('#showWindowButton').jqxButton({ width: '70px' });
                $('#hideWindowButton').jqxButton({ width: '65px' });
                $('#resizeCheckBox').jqxCheckBox({ width: '185px', checked: true });
                $('#dragCheckBox').jqxCheckBox({ width: '185px', checked: true });
            };

            //Creating the demo window
            function _createWindow() {
                $('#window').jqxWindow({
                    showCollapseButton: true, maxHeight: 400, maxWidth: 700, minHeight: 200, minWidth: 200, height: 300, width: 500,
                    initContent: function () {
                        $('#tab').jqxTabs({ height: '100%', width:  '100%' });
                        $('#window').jqxWindow('focus');
                    }
                });
            };

            return {
                config: {
                    dragArea: null
                },
                init: function () {
                    //Creating all jqxWindgets except the window
                    _createElements();
                    //Attaching event listeners
                    _addEventListeners();
                    //Adding jqxWindow
                    _createWindow();
                }
            };
        } ());

        $(document).ready(function () {  
            //Initializing the demo
            basicDemo.init();
        });
    </script>
</head>
  <body>
	

							
    <div class="container">
		<nav class="navbar navbar-fixed-top navbar-default" role="navigation">
			<div class="container-fluid">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#" style="color:#5A057A;">CalMapIt</a>
				</div>
				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav">
						<li><a  href="#" title="Click to open Calendar" style="color:#5A057A;" >Cal</a></li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Map Controls" style="color:#5A057A;">Map<b class="caret"></b></a>
							<ul class="dropdown-menu">
								<li><a href="#"><i class="fa fa-print"  style="color:#5A057A;"></i> Print Map</a></li>
								<li><a href="#"><i class="fa fa-calendar-o"  style="color:#5A057A;"></i> Print Calendar</a></li>
								<li><a href="#"><i class="fa fa-hand-o-right" style="color:#5A057A;"></i> Print Directions</a></li>
								<li><a href="#"><i class="fa fa-list" style="color:#5A057A;"></i> Print Itinerary</a></li>
								<li><a href="#"><i class="fa fa-paper-plane-o" style="color:#5A057A;"></i> Email Itinerary</a></li>
								<li><a href="/contact" id="contact"><i class="fa fa-user" style="color:#5A057A;"></i> Contact</a></li>
							</ul>
						</li>
						<li><a href="#" id="my-button" title="First Time Visitor?" style="color:#794CFF;">First Time?</a></li>
						<li><a  href="#" title="Click to open Help" style="color:#5A057A;" >Help</a></li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Features" style="color:#5A057A;">Features<b class="caret"></b></a>
							<ul class="dropdown-menu">
								<li><a href="#"> Calendar Events</a></li>
								<li><a href="#"> Map</a></li>
								<li><a href="#"> Directions</a></li>
								<li><a href="#"> Places</a></li>
								<li><a href="#"> Itinerary</a></li>
								<li><a href="#"> Event Types</a></li>
								<li><a href="#"> Search</a></li>
								<li><a href="#"> Filter</a></li>
								<li><a href="#"> Add Events</a></li>
								<li><a href="#"> StreetView</a></li>
								<li><a href="#"> MultiView</a></li>
								
							</ul>
						</li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Libraries" style="color:#5A057A;">Libraries<b class="caret"></b></a>
							<ul class="dropdown-menu">
								<li><a href="#"> Google Maps API v3</a></li>
								<li><a href="#"> Google Calendar</a></li>
								<li><a href="#"> Google Places</a></li>
								<li><a href="#"> Google Weather</a></li>
								<li><a href="#"> Google Gmail</a></li>
								<li><a href="#"> Google Contacts</a></li>
								<li><a href="#"> Twitter Bootstrap</a></li>
								<li><a href="#"> Google Fusion Tables</a></li>
								<li><a href="#"> Google Spreadsheets</a></li>
								<li><a href="#"> Google App Scripts</a></li>
								<li><a href="#"> bubble.js</a></li>
								<li><a href="#"> JQuery</a></li>
								<li><a href="#"> Jquery UI</a></li>
								<li><a href="#"> prototype</a></li>
								<li><a href="#"> awesome fonts</a></li>
							</ul>
						</li>
						<div id="social_btuttons">
					<div class="social-icons" >
                        <ul>
                                <a href="#facebook">
                                    <img alt="" src="images/icons/facebook.png" />
                                </a>
                                <a href="#twitter">
                                    <img alt="" src="images/icons/twitter.png" />
                                </a>
                                <a href="#gplus">
                                    <img alt="" src="images/icons/gplus.png" />
                                </a>
                                <a href="#linkedin">
                                    <img alt="" src="images/icons/linkedin.png" />
                                </a>
								 <a href="#instagram">
                                    <img alt="" src="images/icons/instagram.png" />
                                </a>
                                <a href="#dribblr">
                                    <img alt="" src="images/icons/dribbblr.png" />
                                </a>
                        </ul>
                    </div>
					 </div>
					</ul>
					<form class="navbar-form navbar-left" role="search">
						<div class="form-group">
							<input type="text" style="width:75px;"class="form-control" placeholder="Search for Photos" value="" id="event_search">
						</div>
						<button type="submit" class="btn btn-default btn-xs" onClick="showEvent()"><i class="fa fa-search"></i></button>
					</form>
					
					<ul class="nav navbar-nav navbar-right">
						<li><a href="http://shmik.com" style="color:#006633;">Shmik</a></li>
						<li><a href="#" style="color:#D90000;" onClick="closeall()">Close all</a></li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" style="color:#5A057A;">Views <b class="caret"></b></a>
							<ul class="dropdown-menu">
								<li class="divider">Map Views</li>
								<li><a href="#streetview" style="color:#5A057A;">StreetView</a></li>
								<li><a href="#multiview" style="color:#5A057A;">MultiView</a></li>
								<li><a href="#top" style="color:#5A057A;">EventView</a></li>
								<li class="divider">Map Layers</li>
								<li><input type="button" value="Show Bike Layer" id="Bike Button" style="color:#5A057A;"></li>
								<li><input type="button" value="Show Animation" onClick="animateCircle()" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off Photos" id="PanoramioButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off Trip Path" id="flightPathButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off Weather" id="WeatherButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off Transit" id="TransitButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off Fusionlayer" id="FusionButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off Traffic" id="TrafficButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off Clouds" id="CloudButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Turn On/Off georssLayer" id="GeoRSSButton" style="color:#5A057A;"></li>
								<li><input type="button" value="Toggle Street View" onclick="toggleStreetView();" style="color:#5A057A;"></li>
								<li class="divider">Calendar</li>
								<li><a href="https://www.google.com/calendar/render" style="color:#5A057A;">Calendar</a></li>								
							</ul>
						</li>
					</ul>
				</div><!-- /.navbar-collapse -->
			</div><!-- /.container-fluid -->
        </nav>
    </div><!-- /.container  -->
    </nav><!-- this must be here to offset another nav div added by jquery -->
    <div class="navbar-offset">
	</div>
	<div id="infoPanelBottom">				
		<div id="legend">
		  <Strong>Event Types</Strong>
		</div>	
	</div>
    <div id="map_canvas">
	
    </div>
	<div  id="tabs" class="tabs" style="display:none;">
	</div>
	<div class="row main-row">
		<div class="col-sm-4 col-md-3 sidebar sidebar-left pull-left" style="overflow:auto;">
			<div class="panel-group sidebar-body" id="accordion-left">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h4 class="panel-title">
							<a data-toggle="collapse" href="#layers">
								<i class="fa fa-filter" style="color:#5A057A;"> </i> Filter events by types or dates
							</a>
							<span class="pull-right slide-submenu">
								<i class="fa fa-chevron-left"></i>
							</span>
						</h4>
					</div>
					<div id="layers" class="panel-collapse collapse in" style="height:40%;">
						<div class="panel-body">
							<div id="placesInputs">
								<!--<p class='mute' style="float: left;"><h5>Filter by Event Types<span class='mute'>(<a href='./about.html#where-did-you-get-your-data-from'>?</a>)</span></h5>-->
								<div class="bs-example" role="toolbar">
									Filter events by types or dates
									<form class="form-inline" style="background-color:#BFFFDF;color:#000000; height:90%;">								
										<div class="actions">
											<div class="button">
												<label for="gmap_keyword">Show all Events</label>
												<button type="button" class="btn btn-info btn-xs"  title="Show all Events" Style="background:#4CFFD2;" id="all" onclick="showAll();"><a href="#"><span class="glyphicon glyphicon-refresh"></span>  </a></button>
												<button type="button" class="btn btn-info btn-xs"  title="Show/Hide Legend" Style="background:#4CFFD2;" id="ToggleBottom"  onclick="showLegend();"><a href="#"><span class="glyphicon glyphicon-off"></span>  </a></button>
												<div style="float: left;">
													<div>
														<input type="button" value="Open" id="showWindowButton" />
														<input type="button" value="Close" id="hideWindowButton" style="margin-left: 5px" />
													</div>
													<div style="margin-top: 10px;">
														<div id="resizeCheckBox">
															Resizable
														</div>
														<div id="dragCheckBox">
															Enable drag
														</div>
													</div>
												</div>
												<label for="gmap_keyword"><small align="bottom">Currelntly showing:</small></label>
												<span class="badge"><div id="EventsListType2"style="background-color:#000000;color:#F1F1F1;"></div></span><span class="badge"><div id="EventsListCount2"></div></span>
											</div>
											<div class="button">
												<label for="gmap_keyword">Filter by the most common event types</label>
												<button type="button" class="btn btn-info btn-xs"  title="Attractions" Style="background:#4CFFD2;" onclick="showAllTypes('attraction');"><a href="#"><span class="fa fa-picture-o"></span>  </a></button>
												<button type="button" class="btn btn-info btn-xs"  title="Sightseeing" Style="background:#4CFFD2;" onclick="showAllTypes('sightseeing');"><a href="#"><span class="fa fa-binoculars"></span> </a></button>
												<button type="button" class="btn btn-info btn-xs"  title="Drives" Style="background:#4CFFD2;" onclick="showAllTypes('drive');"><a href="#"><span class="fa fa-car"></span> </a></button>
												<button type="button" class="btn btn-info btn-xs"  title="Motels" Style="background:#4CFFD2;" onclick="showAllTypes('motel');"><a href="#"><span class="fa fa-suitcase"></span> </a></button>
												<button type="button" class="btn btn-info btn-xs"  title="Shopping" Style="background:#4CFFD2;" onclick="showAllTypes('shopping');"><a href="#"><span class="fa fa-shopping-cart"></span> </a></button>
												<button type="button" class="btn btn-info btn-xs"  title="Themeparks" Style="background:#4CFFD2;" onclick="showAllTypes('theme');"><a href="#"><span class="glyphicon glyphicon-tower"></span> </a></button>
												<button type="button" class="btn btn-info btn-xs"  title="Food" Style="background:#4CFFD2;" onclick="showAllTypes('food');"><a href="#"><span class="glyphicon glyphicon-cutlery"></span> </a></button>
											</div>
											<div class="button">
												<form class="navbar-form navbar-left" role="search">
													<label for="gmap_keyword">Search all event types</label>
													<div class="form-group">
														<input type="text" style="height:23px;"class="form-control" placeholder="Search for Events" value="" id="event_search">
													</div>
													<button type="submit" class="btn btn-default btn-xs" onClick="showEvent()"><i class="fa fa-search"></i></button>
												</form>
											</div>
											<div class="button">
												<label for="gmap_keyword">Select from all event types</label>
												<div id="dropdown_menu"></div>
											</div>
											<div class="button">
												<label for="gmap_keyword">Select from all event locations</label>
												<div id="dropdown_menu2"></div>
											</div>
											<div class="button">
												<label for="gmap_keyword">Filter by Event Dates<span class='mute'>(<a href='./about.html#where-did-you-get-your-data-from'>?</a>)</span></label>
												<div id="s-h">
													<div id="s1" class="goog-twothumbsliderslider" style="height: 20px;width:60%; left:20%;right:20%;">
													  <div style="position:absolute;width:100%;top:9px;border:1px inset black;overflow:hidden;height:0"></div>
													  <div id="value" class="goog-twothumbslider-value-thumb"><span style="bottom:2px;">F</span></div>
													  <div id="extent" class="goog-twothumbslider-extent-thumb"><span style="bottom:2px;">T</span></div> 
													</div>
													<div id="goog-twothumbslider-value-thumb-left"><button type="button" class="btn btn-info btn-xs " Style="background:#4CFFD2;color:#004030">Mar 2016</button></div>
													<div id="goog-twothumbslider-value-thumb-right"><button type="button" class="btn btn-info btn-xs " Style="background:#00FFFF;color:#004030">May 2016</button></div>
												</div>
											</div>
										</div>
									</form>
									</br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br>
									<small align="bottom"><a href="#streetview">See the Street View Display</a></small>  --- <small><a href="#multiview">See the Multi View Display</a></small>
								</div>
							</div>
						</div>
					</div>
				</div><!-- /.filters -->
				<div class="panel panel-default" id="Places" >
					<div class="panel-heading">
						<h4 class="panel-title">
							  <a data-toggle="collapse" href="#places">
								<i class="fa fa-eye" style="color:#5A057A;"> </i> Search for Shopping, Services, Food Etc
							  </a>
						</h4>
					</div>
					<div id="places" class="panel-collapse collapse ">
						<div class="panel-body">
							<div id="placesInputs">
								<div class="bs-example" role="toolbar">
									Search for Places
									<form class="form-inline" style="background-color:#BFFFDF;color:#000000;">								
										
											<div class="button">
												<label for="gmap_where">Where:</label>
												<input id="gmap_where" type="text" name="gmap_where" />
											</div>
											<div id="button2" class="button" onclick="findAddress(); return false;">Search for address</div>
											<div class="button">
												<label for="gmap_keyword">Keyword (optional):</label>
												<input id="gmap_keyword" type="text" name="gmap_keyword" />
											</div>
											<div class="button">
												<label for="gmap_type">Type:</label>
												<select id="gmap_type">
													<optgroup label="Attractions/Activities">
														<option value="amusement_park">Amusement Park</option>
														<option value="aquarium">Aquarium</option>
														<option value="art_gallery">Art Gallery</option>
														<option value="bowling_alley">Bowling Alley</option>
														<option value="casino">Casino</option>
														<option value="library">Library</option>
														<option value="movie_theater">Movie Theater</option>
														<option value="museum">Museum</option>
														<option value="park">Park</option>
														<option value="zoo">Zoo</option>
													</optgroup>
													<optgroup label="Places to Eat">
														<option value="bakery">Gallery</option>
														<option value="cafe">Cafe</option>
														<option value="food">Food</option>
														<option value="meal_delivery">Meal Delivery</option>
														<option value="meal_takeaway">Meal Takeaway</option>
														<option value="restaurant">Restaurant</option>
														<option value="restaurant">Dunkin' Donuts</option>
													</optgroup>
													<optgroup label="Services">
														<option value="atm">ATM</option>
														<option value="bank">Bank</option>
														<option value="campground">Campground</option>
														<option value="car_rental">Car Rental</option>
														<option value="car_wash">Car Wash</option>
														<option value="doctor">Doctor</option>
														<option value="gas_station">Petrol Station</option>
														<option value="hospital">Hospital</option>
														<option value="laundry">Laundry</option>
														<option value="lodging">Accomodation</option>
														<option value="parking">Parking</option><option value="amusement_park">Gallery</option>
														<option value="police">Police</option>
														<option value="rv_park">RV Park</option><option value="amusement_park">Gallery</option>
														<option value="subway_station">Subway Station</option>
														<option value="train_station">Train Station</option>
													</optgroup>
													<optgroup label="Shopping">
														<option value="book_store">Books</option>
														<option value="clothing_store">Clothes</option>
														<option value="convenience_store">Convenience</option>
														<option value="department_store">Department</option>
														<option value="electronics_store">Electronics</option>
														<option value="grocery_or_supermarket">Supermarket</option>
														<option value="hardware_store">Hardware</option>
														<option value="home_goods_store">Home Goods</option>
														<option value="shopping_mall">Mall</option>
														<option value="store">Store</option>
														<option value="gas_station">Petrol</option>
													</optgroup>
												</select>
											</div>
											<div class="button">
												<label for="gmap_radius">Radius:</label>
												<select id="gmap_radius">
													<option value="500">500</option>
													<option value="1000">1000</option>
													<option value="1500">1500</option>
													<option value="5000">5000</option>
												</select>
											</div>
											<input type="hidden" id="lat" name="lat" value="40.7143528" />
											<input type="hidden" id="lng" name="lng" value="-74.0059731" />
											<div id="button1" class="button" onclick="findPlaces(); return false;">Search for objects</div>
											<div id="button3" class="button" onclick="clearOverlays(); return false;">Reset</div>
										
									</form>
									<div id="placesSteps">
										<div id="listing">
										  <table id="resultsTable"></br></br></br>
											<tbody id="results"><p class="msg">Places Will Render Here</p></tbody>
										  </table>
										</div>
									</div></br></br>
									<img src='images/powered-by-google-on-white.png' alt='Powered by Google'/></br>
									<small align="bottom"><a href="#streetview">See the Street View Display</a></small>  --- <small><a href="#multiview">See the Multi View Display</a></small>
								</div>
							</div>
							
						</div>
					</div>
				</div><!-- /.Places -->
				<div class="panel panel-default" style="height:20%;">
					<div class="panel-heading">
						<h4 class="panel-title">
							<a data-toggle="collapse" href="#properties">
								<i class="fa fa-location-arrow" style="color:#5A057A;"> </i> Get Directions 
							</a>
						</h4>
					</div>
					<div id="properties" class="panel-collapse collapse ">
						<div class="panel-body">
							<form class="form-inline" style="background-color:#BFFFDF;color:#000000;">
								Search for Directions
								<div class="row"></br>
									<label style="float:left;margin-left:5px;padding-top:6px;padding-left:30%;">S</label><input type="text" value="" id="dirSource" style="float:left;"/></br></br>
									<label style="float:left;margin-left:5px;padding-top:6px;padding-left:30%;">F</label><input type="text" value="" id="dirDestination" style="float:left;"/>
								
									<div class="bs-example" role="toolbar" style="float:left;padding-left:30px;">
										<div class="btn-group btn-group-xs" style=" padding-bottom:10px;padding-top:-9px;">
											<button type="button" class="btn btn-info btn-xs" Style="background:#4CFFD2;" title="Search for Directions" ><a href="#" id="getDirections" ><span class="fa fa-search"></span>  Search</a></button>	
											<button type="button" class="btn btn-info btn-xs" Style="background:#4CFFD2;" title="Print Directions" ><a href="PrintDirections" id="PrintDirectionsLeft"><span class="fa fa-print"></span>  Print</a></button>	
												
										</div>
									</div>
								</div>
							</form>		
							<form class="form-inline" style="background-color:#BFFFDF;color:#000000;">
								Select from the list of destinations
								<div class="row" style="line-height: 0.85">
									<label style="float:left;margin-left:20%;">S</label>
									<select id="dirSourceLeft" data-runid="0" onchange="calcRoute();"style="float:left;left:20%;">
										<option value="426 W 39th St, New York, NY, United States" >Hells Kitchen</option>
										<option value="1605 Broadway, New York City, NY, United States" >Crowne Plaza</option>
										<option value="3790 S Las Vegas Blvd, Las Vegas, NV, United States" >NY NY Las Vegas</option>
										<option value="grand canyon, az">Grand Canyon</option>
										<option value="page, az">Page</option>
										<option value="flagstaff, az">Flagstaff</option>
										<option value="phoenix, az">Phoenix</option>
										<option value="las vegas, nv">Las Vegas</option>
										<option value="yosemite village, ca ">Yosemite Village</option>
										<option value="777 Story Rd, San Jose, CA, United States" >Walmart San Jose</option>
										<option value="1590 Berryessa Rd,San Jose, CA, United States" >Flea Market San Jose</option>
										<option value="211 S 1st St, San Jose, CA, United States" >Sheraton San Jose</option>
									</select>
									</br></br>
									<label style="float:left;margin-left:20%;">F</label>
									<select id="dirDestinationLeft" data-runid="0" onchange="calcRoute();"style="float:left;left:20%;">
										<option value="426 W 39th St, New York, NY, United States" >Hells Kitchen</option>
										<option value="1605 Broadway, New York City, NY, United States" >Crowne Plaza</option>
										<option value="3790 S Las Vegas Blvd, Las Vegas, NV, United States" >NY NY Las Vegas</option>
										<option value="grand canyon, az">Grand Canyon</option>
										<option value="page, az">Page</option>
										<option value="flagstaff, az">Flagstaff</option>
										<option value="phoenix, az">Phoenix</option>
										<option value="las vegas, nv">Las Vegas</option>
										<option value="yosemite village, ca ">Yosemite Village</option>
										<option value="777 Story Rd, San Jose, CA, United States" >Walmart San Jose</option>
										<option value="1590 Berryessa Rd,San Jose, CA, United States" >Flea Market San Jose</option>
										<option value="211 S 1st St, San Jose, CA, United States" >Sheraton San Jose</option>
									</select></br>
									<button type="button" class="btn btn-info btn-xs" Style="background:#4CFFD2;" title="Reset Directions" ><a href="#" id="ResetDirectionsLeft" onclick="clearDirections(); return false;"><span class="fa fa-refresh"></span>  Reset</a></button>	
									</br></br></br>
									
								</div>	
								<small align="bottom"><a href="#streetview">See the Street View Display</a></small>  --- <small><a href="#multiview">See the Multi View Display</a></small>
							</form>	
														
							<div id="directionSteps">
								<p class="msg">Direction Steps Will Render Here</p>
							</div>
						</div>
					</div>
				</div><!-- /.Directions -->
				

				<div class="panel panel-default" id="Alerts" >
					<div class="panel-heading">
						<h4 class="panel-title">
							  <a data-toggle="collapse" href="#feeds">
								<div class="new-cal"></div><i class="fa fa-rss" style="color:#5A057A;"> </i> Keep up-to-date with tourist information feeds
							  </a>
						</h4>
					</div>
					<div id="feeds" class="panel-collapse collapse ">
						<div class="panel-body">
							<script type="text/javascript" src="js/rss.js"></script> 
							<script type="text/javascript">(function() {var params = {rssmikle_url: "http://yosemiteblog.com/feed/|http://www.nps.gov/grca/planyourvisit/upload/grca-backcountry.xml|http://w1.weather.gov/xml/current_obs/KBCE.rss|http://www.nature.nps.gov/assets/rss/NRSS.xml",rssmikle_frame_width: "300",rssmikle_frame_height: "400",rssmikle_target: "_blank",rssmikle_font: "Arial, Helvetica, sans-serif",rssmikle_font_size: "10",rssmikle_border: "off",responsive: "on",rssmikle_css_url: "",text_align: "left",text_align2: "left",corner: "off",scrollbar: "on",autoscroll: "on",scrolldirection: "up",scrollstep: "3",mcspeed: "20",sort: "New",rssmikle_title: "on",rssmikle_title_sentence: "Travel Info Live Feeds",rssmikle_title_link: "",rssmikle_title_bgcolor: "#4CFFD2",rssmikle_title_color: "#000000",rssmikle_title_bgimage: "",rssmikle_item_bgcolor: "#CEFFE7",rssmikle_item_bgimage: "",rssmikle_item_title_length: "55",rssmikle_item_title_color: "#000000",rssmikle_item_border_bottom: "on",rssmikle_item_description: "on",item_link: "on",rssmikle_item_description_length: "150",rssmikle_item_description_color: "#000000",rssmikle_item_date: "gl2",rssmikle_timezone: "Australia/Sydney",datetime_format: "%e.%m.%Y %l:%M:%S %p",rssmikle_item_description_tag: "on_html",rssmikle_item_description_image_scaling: "on",article_num: "15",rssmikle_item_podcast: "off",keyword_inc: "",keyword_exc: ""};feedwind_show_widget_iframe(params);})();</script>
							<div style="font-size:10px; text-align:center; width:100%; margin:0; ">
								<a href="http://feed.mikle.com/" target="_blank" style="color:#CFFFBF;">RSS Feed Widget</a>
								<!--Please display the above link in your web page according to Terms of Service.-->
								<!-- end feedwind code -->	
							</div>
						</div>
					</div>
				</div><!-- /.Alerts -->
			</div><!-- /.Accordian Left Sidebar -->
		</div><!-- /.Sidebar Left -->
		
		
		<div class="col-sm-4 col-md-3 sidebar sidebar-right pull-right">
			<div class="panel-group sidebar-body" id="accordion-right" >
				<div class="panel panel-default">
					<div class="panel-heading">
						<h4 class="panel-title">
							<a data-toggle="collapse" href="#taskpane" style="float:right;">
								<span class="badge"><div id="EventsListType"></div></span><span class="badge"><div id="EventsListCount"></div></span>Events <i class="fa fa-calendar" style="color:#5A057A;"></i>
							</a>	  
							<span class="pull-left slide-submenu">
								<i class="fa fa-chevron-right"> </i>
							</span>
						</h4> 
						<h4 style="left:0px; font-size: 10px;"><div id="EventsListText" style="float: left;">&#032;</div>&#032;<div id="EventsListQuery" style="float: left;">&#032;</div>&#032;</h4>						
					</div>
					<div id="taskpane" class="panel-collapse collapse in">
						<div class="panel-body" id="tableheight">
							<div id="directionStepsRight">
								<p>Events Will Render Here</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
								<p>This is just some filler text</p>
							</div>
						</div>
					</div>
				</div>
				
			</div><!-- /.Accordian Right Sidebar -->
		</div><!-- /.Sidebar Right -->
		
	</div><!-- /.Main Row -->
	<div id="jqxWidget">
        
        <div style="width: 100%; height: 650px; margin-top: 50px; bottom:100px;left:35%;" id="mainDemoContainer">
            <div id="window">
                <div id="windowHeader">
                    <span>
                        <img src="images/movie.png" alt="" style="margin-right: 15px" />CalMapIt
                    </span>
                </div>
                <div style="overflow: hidden;" id="windowContent">
                    <div id="tab">
                        <ul style="margin-left: 30px;">
                            <li>Itineraries</li>
                            <li>Drives</li>
                            <li>Suggestions</li>
                            <li>Bucket list</li>
                            <li>Events</li>
							<li>Types</li>
							<li>Reviews</li>
							<li>Photos</li>
							<li>Features</li>
							<li>ToDo</li>
							<li>Dev</li>
                        </ul>
                        <div>
                            <img src="images/itineraries.png" style="float: left; margin: 10px;" alt="" />
                            This will contain itineraries. When you click on an itinerary it will list on the right side_bar
							the locations and plot markers to the map.
						</div>   
						<div>
                            <img src="images/drives.png" style="float: left; margin: 10px;" alt="" />
                             This will contain Drives. When you click on an Drive it will list on the right side_bar
							the locations with waypoints and plot markers to the map.
                        </div>
                        <div>
                            <img src="images/suggestions.png" style="float: left; margin: 10px;" alt="" />
                             This will contain Suggestions. When you click on a Suggestions it will list information 
							 via a pop up modal.
                        </div>
                        <div>
                            <img src="images/bucket.png" style="float: left; margin: 10px;" alt="" />
                            This will contain Bucket list. When you save items from itineraries,Drives,Suggestions or 
							Places it will add item to bucket list in MySQL db.
                        </div>
                        <div>
                            <img src="images/events.png" style="float: left; margin: 10px;" alt="" />
                            This will contain Events list. When you click on an Event it will list on the right side_bar
							the locations and plot markers to the map. 
							This will have option to load google calendar via url arguments
                        </div>
						<div>
                            <img src="images/types.png" style="float: left; margin: 10px;" alt="" />
                            This will contain types list. When you click on an type it will filter event list on the right side_bar
							the locations and re plot markers to the map. 
							<div id="infoPanelBottom">				
								<div id="legend">
								  <Strong>Event Types</Strong>
								</div>	
							</div>
                        </div>
						<div>
                            <img src="images/reviews.png" style="float: left; margin: 10px;" alt="" />
                            This will contain reviews. When you click on a reviews it will list information 
							 via a pop up modal.
						</div>   
						<div>
                            <img src="images/Photos.png" style="float: left; margin: 10px;" alt="" />
                            This will contain Photos. When you click on a Photos it will display slide show 
							 via a pop up modal.
                        </div>
                        <div>
                            <img src="images/Features.png" style="float: left; margin: 10px;" alt="" />
							<div style="border: none;" id='dataTable'></div>
                             This will contain Features. Just a Dev features list to implement.
                        </div>
                        <div>
                            <img src="images/todo.png" style="float: left; margin: 10px;" alt="" />
                            This will contain todo list. Just a Dev todo list from the HTML code.
                        </div>
                        <div>
                            <img src="images/Dev.png" style="float: left; margin: 10px;" alt="" />
                            This will contain dev list - just console debug info, will write to a log file too. 
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
	<div class="mini-submenu mini-submenu-left pull-left">
		<i class="fa fa-list-alt"></i>
	</div>
	<div class="mini-submenu mini-submenu-right pull-right">
		<i class="fa fa-tasks"></i>
	</div>
	<div class="messagepop pop">
		<form method="post" id="new_message" action="/messages">
			<p><label for="email">Your email or name</label><input type="text" size="30" name="email" id="email" /></p>
			<p><label for="body">Message</label><textarea rows="6" name="body" id="body" cols="35"></textarea></p>
			<p><input type="submit" value="Send Message" name="commit" id="message_submit"/> or <a class="close" href="/">Cancel</a></p>
		</form>
	</div>
	</div><!-- this must be here to offset another nav div added by jquery -->
	<div id="element_to_pop_up">
		<a class="b-close">x<a/>
	</div>
		<!-- Button that triggers the popup -->
		<!-- Element to pop up -->
<div id="element_to_pop_up2">
	<a class="b-close">x<a/>
   <body>
	<div class="wrapper">
		<div id="clouds"></div>
		<div id="clouds2"></div>
		<div id="plane"></div>
		<div class="container">
			<div class="coming-soon">
				<div class="top-holder">
					<div class="page-title">
						<h1></h1>
					</div>
					<div class="page-desc">
						Planning the next trip to..... America!
						
					</div>
					
				</div></br></br></br>
					<div class="page-content">
						<string><h4>What's CalMapIt?</h4></strong></br>
						<ul>
						<li>Calmap is an online calendar map. Based on a Google Calendar.</li>
						<li>Planning - Plan your next trip or view previous trips.</li>
						<li>Discover - Find new places to explore, add then to the calendar and map.</li>
						<li>Directions - Get directions to and from any event or newly discovered location.</li>
						<li>Itinerary - Produce a perfect printable itinerary for offline use.</li>
						<li>Reviews - Learn where to go from other users reviews.</li>
						<li>Pictures and Video - Add a complete photographic journal to events.</li>
						<li>Fully integrated with event reminder - Be reminded of important events.</li>
						<li>Mobile happy. Run this webapp on any device, take your calmap with you wherever you go.</li>
						</ul>
					</div>
			</div>
		</div>		
	</div>
	
</body>

</div>
  				
		
    <div id="info-content">
      
    </div>
	<h4><p class='mute'><b>Street View Directions by Google Calendar</b></h4>
		<a id="streetview"></a><small><div id="Panellinks"><a href="#top">Events View</a></small>  --- <small><a href="#multiview">Multi View</a></div></small>
		<iframe src="./streetviewdirections.html" width="100%" height="880" frameborder="0" scrolling="no" align="centre"></iframe>
		<hr />
		
		<h4><p class='mute'><b>Multi View Directions by Dual Maps</b></h4>
		<a id="multiview"></a><small><div id="Panellinks"><a href="#top">Events View</a></small>  --- <small><a href="#streetview">Street View</a></div></small>
		<iframe width="100%" height="880" frameborder="0" scrolling="no" align="centre" src="http://data.dualmaps.com/dualmaps4d/map.htm?x=0&y=0&z=16&gm=3&ve=4&gc=0&bz=0&bd=0&mw=0&sv=1&sva=1&svb=0&svp=0&svz=0&svm=2&svf=1&sve=1&mi=3&mg=1&mv=1&sb=1&traffic=1&photo=1&wikipedia=1&addr=3570 S Las Vegas Blvd Las Vegas, NV 89109 United States" ></iframe>
	
	<script type="text/javascript" src="js/shmiktest.js"></script> 
	<script language="javascript" type="text/javascript">	
	var basicDemo = (function () {
            //Adding event listeners
            function _addEventListeners() {
                $('#resizeCheckBox').on('change', function (event) {
                    if (event.args.checked) {
                        $('#window').jqxWindow('resizable', true);
                    } else {
                        $('#window').jqxWindow('resizable', false);
                    }
                });
                $('#dragCheckBox').on('change', function (event) {
                    if (event.args.checked) {
                        $('#window').jqxWindow('draggable', true);
                    } else {
                        $('#window').jqxWindow('draggable', false);
                    }
                });
                $('#showWindowButton').click(function () {
                    $('#window').jqxWindow('open');
                });
                $('#hideWindowButton').click(function () {
                    $('#window').jqxWindow('close');
                });
            };
            //Creating all page elements which are jqxWidgets
            function _createElements() {
                $('#showWindowButton').jqxButton({ width: '70px' });
                $('#hideWindowButton').jqxButton({ width: '65px' });
                $('#resizeCheckBox').jqxCheckBox({ width: '185px', checked: true });
                $('#dragCheckBox').jqxCheckBox({ width: '185px', checked: true });
            };
            //Creating the demo window
            function _createWindow() {
                $('#window').jqxWindow({
                    showCollapseButton: true, maxHeight: 400, maxWidth: 700, minHeight: 200, minWidth: 200, height: 300, width: 500,
                    initContent: function () {
                        $('#tab').jqxTabs({ height: '100%', width:  '100%' });
                        $('#window').jqxWindow('focus');
                    }
                });
            };
            return {
                config: {
                    dragArea: null
                },
                init: function () {
                    //Creating all jqxWindgets except the window
                    _createElements();
                    //Attaching event listeners
                    _addEventListeners();
                    //Adding jqxWindow
                    _createWindow();
                }
            };
			
		
			
			
        } ());
    $(document).ready(function() {
		basicDemo.init();
		$('#element_to_pop_up').bPopup({
		content:'iframe', //'ajax', 'iframe' or 'image'
		contentContainer:'.customcontent',
		loadUrl: 'index.html' //Uses jQuery.load()
		});
		$('#element_to_pop_up2').bPopup({
			
			fadeSpeed: 'slow', //can be a string ('slow'/'fast') or int
			followSpeed: 1500, //can be a string ('slow'/'fast') or int
			modalColor: 'DimGray',
			opacity: 0.8
			//onOpen: function() { alert('onOpen fired'); }, 
			//onClose: function() { alert('onClose fired'); }
		}, 
		function() {
		   // alert('Callback fired');
		});
		
     	$("#dataTable").jqxDataTable(
            {
                width: '100%',
                height: '100%',
                source: dataAdapter,
                sortable: true,
                columns: [
                      { text: 'First Name', dataField: 'firstname', width: '30%' },
                      { text: 'Last Name', dataField: 'lastname', width: '30%' },
                      { text: 'Title', dataField: 'title' }
                ]
            });
      //$('#my_popup_close').popup();

    });

					
					var query2;
					var el = document.getElementById('s1');
					var exel = document.getElementById('extent');
					s = new goog.ui.TwoThumbSlider;
					s.decorate(el);
					s.setMinimum(1457400399000);
					s.setMaximum(1462139999000);
					s.setExtent(1462139999000);
					s.setUnitIncrement(86400);
					s.setMoveToPointEnabled(true);
					//querystart = "SELECT * FROM "+tableId+" WHERE 'Event Start' > '2016.03.8' AND 'Event Start' < '2016.03.9'";		
					//queryTextStart = encodeURIComponent(querystart);
					//startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryTextStart);
					//startquery.send(getData);
					//console.log("s is type ",typeof(s),s);
					goog.events.listen(
						
						s.getContentElement(),
						[goog.events.EventType.MOUSEUP,
						 goog.events.EventType.KEYUP,
						 goog.events.EventType.MOUSEOUT
						 ],
						 
						 
						 function() {
								
							//startquery.send(getData);
							removeMarkers();
							
						 
							
							//console.log("1st we should be clearing the markers now");
							var dend = new Date(s.getValue()+s.getExtent());
							//dend = parseDate(s.getValue()+s.getExtent());
							var dstart = new Date(s.getValue() - 1); 
							var StartMonth = dstart.getMonth() + 1;
							var EndMonth = dend.getMonth() + 1;
							var fromshortdate = 
							//dstart = parseDate(s.getValue());
							console.log("dstart/dend is ",dstart,dend);
							var querytemp2 = "SELECT * FROM "+tableId+" WHERE 'Event Start' > '03/08/2016'";
							//var querytemp = "SELECT * FROM 1VnXlhSBM_FglBZSnM7UZUWSyi4ZYg29Sg7Wh7pv4 WHERE 'Event Start' > '" + dstart + "'" + " AND 'Event Start' < '" + dend + "'";
							var querytemp = "SELECT * FROM "+tableId+" WHERE 'Event Start' > '" + dstart.getFullYear() + "." + StartMonth + "." + dstart.getDate() + "'" + " AND 'Event Start' < '" + dend.getFullYear() + "." + EndMonth + "." + dend.getDate() + "'";
							var test_return_dstart = ""  +  dstart.getDate() + "/" + StartMonth+ ""; 
							var test_return_dend = ""  + dend.getDate()+ "/" + EndMonth + ""; 
							document.getElementById('EventsListText').innerHTML = " Showing" + "&nbsp";;
							document.getElementById('EventsListQuery').innerHTML = " " +" dates " + " " + test_return_dstart + " to " + test_return_dend + "";
							//document.getElementById('EventsListQuery2').innerHTML = " From " + test_return_dstart + " to " + test_return_dend + "<b>(<a href='./about.html#where-did-you-get-your-data-from'>?</a>)</b><br> ";
							//console.log("test_return_dstart dstart is ",test_return_dstart);
							//console.log("test_return_dend dend is ",dend.toDateString());
							//var text = " scones " + " " + test_return_dstart + " to " + test_return_dend + "";
							//document.body.insertBefore(text, e);
							if(querytemp2!=querytemp){
								query2=querytemp;
								console.log("query2 is ",query2);
								var queryText = encodeURIComponent(query2);
								var startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
								startquery.send(getData);
								layer.setQuery(query2);						
								//document.getElementById('infoPanelBottom').innerHTML += "Query is " + queryText +"<br>";
								document.getElementById('EventsListType').innerHTML = "Date";
								document.getElementById('EventsListType2').innerHTML = "Date";
							} else {
								querytemp = "SELECT * FROM "+tableId+" WHERE 'Event Start' > '03/08/2016'";
								query2=querytemp;
								//document.getElementById('infoPanelBottom').innerHTML += "Query is " + queryText +"<br>";
								queryText = encodeURIComponent(query2);
								startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
								startquery.send(getData);
								//layer.setQuery(query2);
								console.log("part 2 query2 is ",query2);
							}
							
							 
						}
					);
					
					
					
					function showAllTypes(type) {
					  querytemp = "SELECT * FROM "+tableId+" WHERE 'Type' = '"+type+"'";
						query2=querytemp;
						//document.getElementById('infoPanelBottom').innerHTML += "Query is " + queryText +"<br>";
						document.getElementById('EventsListType').innerHTML = " "+ type +" ";
						document.getElementById('EventsListType2').innerHTML = " "+ type +" ";
						queryText = encodeURIComponent(query2);
						startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
						startquery.send(getData);
						//layer.setQuery(query2);
						console.log("part 2 query2 is ",query2);
					  layer.setQuery(query2);
					}
					
					
					function showAllLocations(location) {
						var whereL = "'Event Location' CONTAINS IGNORING CASE '" +
						location + "'";
					  querytemp = "SELECT * FROM "+tableId+" WHERE " + whereL + "";
						query2=querytemp;
						//document.getElementById('infoPanelBottom').innerHTML += "Query is " + queryText +"<br>";
						document.getElementById('EventsListType').innerHTML = "Location";
						document.getElementById('EventsListType2').innerHTML = "location";
						queryText = encodeURIComponent(query2);
						startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
						startquery.send(getData);
						//layer.setQuery(query2);
						console.log("part 2 query2 is ",query2);
					  layer.setQuery(query2);
					}
					
					function showEvent(event_search) {
						  var event_query = document.getElementById("event_search").value;
						console.log("part 2 event_query is ",event_query);
						var where = "'Event Title' CONTAINS IGNORING CASE '" +
						event_query + "'";
					  querytemp = "SELECT * FROM "+tableId+" WHERE " + where + "";
						query2=querytemp;
						//document.getElementById('infoPanelBottom').innerHTML += "Query is " + queryText +"<br>";
						document.getElementById('EventsListType').innerHTML = "Event Search";
						document.getElementById('EventsListType2').innerHTML = "Event Search";
						queryText = encodeURIComponent(query2);
						startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
						startquery.send(getData);
						//layer.setQuery(query2);
						console.log("part 2 query2 is ",query2);
					  layer.setQuery(query2);
					}
					
					
					function showAll() {
					  querytemp = "SELECT * FROM "+tableId+" WHERE 'Event Start' > '03/08/2016'";
						query2=querytemp;
						//document.getElementById('infoPanelBottom').innerHTML += "Query is " + queryText +"<br>";
						document.getElementById('EventsListType').innerHTML = "All";
						document.getElementById('EventsListType2').innerHTML = "All";
						queryText = encodeURIComponent(query2);
						startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
						startquery.send(getData);
						//layer.setQuery(query2);
						//console.log("part 2 query2 is ",query2);
					   layer.setQuery(query2);
					   map.setZoom(4);
					   infoBubble_close2();
					}
					
					function getimages() {
						
					  querytemp = "SELECT 'Type', count() FROM "+tableId+" GROUP by 'Type' ORDER by 'Type'";
						query2=querytemp;
						console.log("getimages query2 is ",query2);
						queryText = encodeURIComponent(query2);
						startquery = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
						startquery.send(getData2);
					}
					
					function getData2(response) {
						if (!response) {
						  alert('no response');
						  return;
						}
						if (response.isError()) {
						  alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
						  return;
						} 
						
						numRows = response.getDataTable().getNumberOfRows();
						numCols = response.getDataTable().getNumberOfColumns();
						
						var today2 = new Date();
						var d2 = today2.getDay();
						console.log("1st d ",d2);
						if (d2 == 0) {
								//Sund2ay is green
								color_of_icons_text = 'green';
								color_of_icons = 10;
						} else if (d2 == 1) {
							//Monday is green
							color_of_icons_text = 'purple';
							color_of_icons = 13;
							console.log("1st day ",d,n);

						} else if (d2 == 2) {
								//Tuesd2ay is green
								color_of_icons_text = 'grey';
								color_of_icons = 11;
						} else if (d2 == 3) {
								//Wed2nesd2ay is green
								color_of_icons_text = 'blue';
								color_of_icons = 9;
						} else if (d2 == 4) {
								//Thursd2ay is green
								color_of_icons_text = 'red';
								color_of_icons = 14;
						} else if (d2 == 5) {
								//Frid2ay is green
								color_of_icons_text = 'orange';
								color_of_icons = 12;
						} else if (d2 == 6) {
							//Saturday is green
							color_of_icons_text = 'yellow';
							color_of_icons = 15;
						} else {
							//Saturday is green
							color_of_icons_text = 'red';
							color_of_icons = 14;
						}
						
						var legend = document.getElementById('legend');
						legend.innerHTML='<div id="showtypeslegendOuter"><table style="width:1024px;"><tr style="width:1024px;float:left;>';
						//legend.innerHTML = '<span>Event types</span></br>';
						for (var i = 0; i < numRows; i++) {
							
								var type = response.getDataTable().getValue(i,0);
								
								if ( type !== "" && type != undefined) {
									console.log("1st type ",type);
									//var div = document.createElement('div');
									
									var image = '<div id="showtypeslegend" style="float:left; display:inline-block;"><a href="#" id="showtypeslegend"><img src= "./icons/'+color_of_icons_text+'/' + type + '.png" style="maxheight:20px;maxwidth:10px;float:left;"><a/></br>' + type + '</div>';
									legend.innerHTML += image;
									
								}
						}
						legend.innerHTML+='</tr></table></div>';
					}
					
				
					function getTypeNames() {
						  // set the query using the parameters
						  var where = "'Type' NOT EQUAL TO '' ";
						var FT_Query_TypeName = "SELECT 'Type', count() FROM "+tableId+" WHERE " + where + " GROUP by 'Type' ORDER by 'Type'";
						//document.getElementById("FTquery4").innerHTML = FT_Query_TypeName; 
						  var queryText = encodeURIComponent(FT_Query_TypeName);
						  var query = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
						  console.log("part 2 FT_Query_TypeName is ",FT_Query_TypeName);
						  //set the callback function
						  query.send(createTypeDropdown);
						}

						function createTypeDropdown(response) {
							if (!response) {
							  alert('no response');
							  return;
							}
							if (response.isError()) {
							  alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
							  return;
							} 
							  //for more information on the response object, see the documentation
							  //http://code.google.com/apis/visualization/documentation/reference.html#QueryResponse
							  numRows = response.getDataTable().getNumberOfRows();
							  numCols = response.getDataTable().getNumberOfColumns();

							  var typeNames = {};
							  for (var i = 0; i < numRows; i++) {
								var typeName = response.getDataTable().getValue(i,0);
								// typeName = typeName.substring(0,typeName.indexOf('('));
								typeNames[typeName] = typeName;
							  }
							  var typeNameDropdown = "<select name='type_select' onchange='handleSelected(this)'>"
							  typeNameDropdown += '<option selected> - Select an Event Type - <\/option>';
							  for (typeName in typeNames) {
								typeNameDropdown += "<option value='"+typeName+"'>"+typeName+"</option>"
							//    document.getElementById('country_list').innerHTML += typeName+"<br>";
							  }
							  typeNameDropdown += "</select>"
							  document.getElementById('dropdown_menu').innerHTML = typeNameDropdown;
						}

					  // ======= This function handles selections from the select box ====
					  function handleSelected(opt) {
						if (opt.selectedIndex > 0) {
						  typeName = geoXML3.nodeValue(opt[opt.selectedIndex]);
						  console.log("opt is ",opt);
						  showAllTypes(typeName);
						} else { 
						  alert("Please pick a type");
						}
					  }
							  
							  
					function getLocationNames() {
						  // set the query using the parameters
						    var whereL1 = "'Event Location' NOT EQUAL TO '' ";
						var FT_Query_TypeName = "SELECT 'Event Location', count() FROM "+tableId+" WHERE " + whereL1 + " GROUP by 'Event Location' ORDER by 'Event Location'";
						//document.getElementById("FTquery4").innerHTML = FT_Query_TypeName; 
						  var queryText = encodeURIComponent(FT_Query_TypeName);
						  var query = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);
						  console.log("part 2 FT_Query_TypeName is ",FT_Query_TypeName);
						  //set the callback function
						  query.send(createTypeDropdown2);
						}

						function createTypeDropdown2(response) {
							if (!response) {
							  alert('no response');
							  return;
							}
							if (response.isError()) {
							  alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
							  return;
							} 
							  //for more information on the response object, see the documentation
							  //http://code.google.com/apis/visualization/documentation/reference.html#QueryResponse
							  numRows = response.getDataTable().getNumberOfRows();
							  numCols = response.getDataTable().getNumberOfColumns();

							  var locationNames = {};
							  for (var i = 0; i < numRows; i++) {
								var locationName = response.getDataTable().getValue(i,0);
								// typeName = typeName.substring(0,typeName.indexOf('('));
								locationNames[locationName] = locationName;
							  }
							  var locationNameDropdown = "<select name='location_select' onchange='handleSelected2(this)'>"
							  locationNameDropdown += '<option selected> - Select an location - <\/option>';
							  for (locationName in locationNames) {
								locationNameDropdown += "<option value='"+locationName+"'>"+locationName+"</option>"
							//    document.getElementById('country_list').innerHTML += typeName+"<br>";
							  }
						  locationNameDropdown += "</select>"
						  document.getElementById('dropdown_menu2').innerHTML = locationNameDropdown;
						}

					  // ======= This function handles selections from the select box ====
					  function handleSelected2(opt) {
						if (opt.selectedIndex > 0) {
						  locationName = geoXML3.nodeValue(opt[opt.selectedIndex]);
						  console.log("locationName is ",locationName);
						  showAllLocations(locationName);
						} else { 
						  alert("Please pick a location");
						}
					  }
					  
					  
					  // ======= This function handles pop up box ==== 
					   // Semicolon (;) to ensure closing of earlier scripting
					// Encapsulation
					// $ is assigned to jQuery
					;(function($) {

						 // DOM Ready
						$(function() {

							// Binding a click event
							// From jQuery v.1.7.0 use .on() instead of .bind()
							$('#my-button').bind('click', function(e) {

								// Prevents the default action to be triggered. 
								e.preventDefault();

								// Triggering bPopup when click event is fired
									//$('#element_to_pop_up').bPopup();
								$('#element_to_pop_up').bPopup({
										fadeSpeed: 'slow', //can be a string ('slow'/'fast') or int
										followSpeed: 1500, //can be a string ('slow'/'fast') or int
										modalColor: 'Black',
										opacity: 0.8
										//onOpen: function() { alert('onOpen fired'); }, 
										//onClose: function() { alert('onClose fired'); }
									}, 
									function() {
									   // alert('Callback fired');
									});
							});

						});

					})(jQuery);

				/*================================================================================
				 * @name: bPopup - if you can't get it up, use bPopup
				 * @author: (c)Bjoern Klinggaard (twitter@bklinggaard)
				 * @demo: http://dinbror.dk/bpopup
				 * @version: 0.9.4.min
				 ================================================================================*/
				 (function(b){b.fn.bPopup=function(z,F){function K(){a.contentContainer=b(a.contentContainer||c);switch(a.content){case "iframe":var h=b('<iframe class="b-iframe" '+a.iframeAttr+"></iframe>");h.appendTo(a.contentContainer);r=c.outerHeight(!0);s=c.outerWidth(!0);A();h.attr("src",a.loadUrl);k(a.loadCallback);break;case "image":A();b("<img />").load(function(){k(a.loadCallback);G(b(this))}).attr("src",a.loadUrl).hide().appendTo(a.contentContainer);break;default:A(),b('<div class="b-ajax-wrapper"></div>').load(a.loadUrl,a.loadData,function(){k(a.loadCallback);G(b(this))}).hide().appendTo(a.contentContainer)}}function A(){a.modal&&b('<div class="b-modal '+e+'"></div>').css({backgroundColor:a.modalColor,position:"fixed",top:0,right:0,bottom:0,left:0,opacity:0,zIndex:a.zIndex+t}).appendTo(a.appendTo).fadeTo(a.speed,a.opacity);D();c.data("bPopup",a).data("id",e).css({left:"slideIn"==a.transition||"slideBack"==a.transition?"slideBack"==a.transition?g.scrollLeft()+u:-1*(v+s):l(!(!a.follow[0]&&m||f)),position:a.positionStyle||"absolute",top:"slideDown"==a.transition||"slideUp"==a.transition?"slideUp"==a.transition?g.scrollTop()+w:x+-1*r:n(!(!a.follow[1]&&p||f)),"z-index":a.zIndex+t+1}).each(function(){a.appending&&b(this).appendTo(a.appendTo)});H(!0)}function q(){a.modal&&b(".b-modal."+c.data("id")).fadeTo(a.speed,0,function(){b(this).remove()});a.scrollBar||b("html").css("overflow","auto");b(".b-modal."+e).unbind("click");g.unbind("keydown."+e);d.unbind("."+e).data("bPopup",0<d.data("bPopup")-1?d.data("bPopup")-1:null);c.undelegate(".bClose, ."+a.closeClass,"click."+e,q).data("bPopup",null);H();return!1}function G(h){var b=h.width(),e=h.height(),d={};a.contentContainer.css({height:e,width:b});e>=c.height()&&(d.height=c.height());b>=c.width()&&(d.width=c.width());r=c.outerHeight(!0);s=c.outerWidth(!0);D();a.contentContainer.css({height:"auto",width:"auto"});d.left=l(!(!a.follow[0]&&m||f));d.top=n(!(!a.follow[1]&&p||f));c.animate(d,250,function(){h.show();B=E()})}function L(){d.data("bPopup",t);c.delegate(".bClose, ."+a.closeClass,"click."+e,q);a.modalClose&&b(".b-modal."+e).css("cursor","pointer").bind("click",q);M||!a.follow[0]&&!a.follow[1]||d.bind("scroll."+e,function(){B&&c.dequeue().animate({left:a.follow[0]?l(!f):"auto",top:a.follow[1]?n(!f):"auto"},a.followSpeed,a.followEasing)}).bind("resize."+e,function(){w=y.innerHeight||d.height();u=y.innerWidth||d.width();if(B=E())clearTimeout(I),I=setTimeout(function(){D();c.dequeue().each(function(){f?b(this).css({left:v,top:x}):b(this).animate({left:a.follow[0]?l(!0):"auto",top:a.follow[1]?n(!0):"auto"},a.followSpeed,a.followEasing)})},50)});a.escClose&&g.bind("keydown."+e,function(a){27==a.which&&q()})}function H(b){function d(e){c.css({display:"block",opacity:1}).animate(e,a.speed,a.easing,function(){J(b)})}switch(b?a.transition:a.transitionClose||a.transition){case "slideIn":d({left:b?l(!(!a.follow[0]&&m||f)):g.scrollLeft()-(s||c.outerWidth(!0))-C});break;case "slideBack":d({left:b?l(!(!a.follow[0]&&m||f)):g.scrollLeft()+u+C});break;case "slideDown":d({top:b?n(!(!a.follow[1]&&p||f)):g.scrollTop()-(r||c.outerHeight(!0))-C});break;case "slideUp":d({top:b?n(!(!a.follow[1]&&p||f)):g.scrollTop()+w+C});break;default:c.stop().fadeTo(a.speed,b?1:0,function(){J(b)})}}function J(b){b?(L(),k(F),a.autoClose&&setTimeout(q,a.autoClose)):(c.hide(),k(a.onClose),a.loadUrl&&(a.contentContainer.empty(),c.css({height:"auto",width:"auto"})))}function l(a){return a?v+g.scrollLeft():v}function n(a){return a?x+g.scrollTop():x}function k(a){b.isFunction(a)&&a.call(c)}function D(){x=p?a.position[1]:Math.max(0,(w-c.outerHeight(!0))/2-a.amsl);v=m?a.position[0]:(u-c.outerWidth(!0))/2;B=E()}function E(){return w>c.outerHeight(!0)&&u>c.outerWidth(!0)}b.isFunction(z)&&(F=z,z=null);var a=b.extend({},b.fn.bPopup.defaults,z);a.scrollBar||b("html").css("overflow","hidden");var c=this,g=b(document),y=window,d=b(y),w=y.innerHeight||d.height(),u=y.innerWidth||d.width(),M=/OS 6(_\d)+/i.test(navigator.userAgent),C=200,t=0,e,B,p,m,f,x,v,r,s,I;c.close=function(){a=this.data("bPopup");e="__b-popup"+d.data("bPopup")+"__";q()};return c.each(function(){b(this).data("bPopup")||(k(a.onOpen),t=(d.data("bPopup")||0)+1,e="__b-popup"+t+"__",p="auto"!==a.position[1],m="auto"!==a.position[0],f="fixed"===a.positionStyle,r=c.outerHeight(!0),s=c.outerWidth(!0),a.loadUrl?K():A())})};b.fn.bPopup.defaults={amsl:50,appending:!0,appendTo:"body",autoClose:!1,closeClass:"b-close",content:"ajax",contentContainer:!1,easing:"swing",escClose:!0,follow:[!0,!0],followEasing:"swing",followSpeed:500,iframeAttr:'scrolling="no" frameborder="0"',loadCallback:!1,loadData:!1,loadUrl:!1,modal:!0,modalClose:!0,modalColor:"#000",onClose:!1,onOpen:!1,opacity:0.7,position:["auto","auto"],positionStyle:"absolute",scrollBar:!0,speed:250,transition:"fadeIn",transitionClose:!1,zIndex:9997}})(jQuery);
 
				</script>	
				  </body>
</html>